<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>嘲弄i</title>
  
  <subtitle>Running Noob!!!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://6-7.xyz/"/>
  <updated>2020-01-10T15:56:59.672Z</updated>
  <id>https://6-7.xyz/</id>
  
  <author>
    <name>嘲弄i</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>linux下编译nginx报错Wno-implicit-fallthrough</title>
    <link href="https://6-7.xyz/20-1-10.html"/>
    <id>https://6-7.xyz/20-1-10.html</id>
    <published>2020-01-10T15:52:26.000Z</published>
    <updated>2020-01-10T15:56:59.672Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
      <category term="nginx" scheme="https://6-7.xyz/tags/nginx/"/>
    
      <category term="Linux" scheme="https://6-7.xyz/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Windows Server安装flash</title>
    <link href="https://6-7.xyz/20-1-3.html"/>
    <id>https://6-7.xyz/20-1-3.html</id>
    <published>2020-01-03T15:05:18.000Z</published>
    <updated>2020-01-03T15:36:42.233Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在搭建桌面虚拟化服务中，使用到了Windows Server系统。其中安装connection server服务必须要使用到flash。所以下面主要讲一下在Windows server上如何安装flash。</p><p>Windows Server 2016/2019显示启用flash，但实际上并未安装flash。想要启用flash，需通过命令行添加Adobe-Flash-For-Windows-Package。</p><p>Windows Server 2016： </p><p>在管理员模式的CMD或Powershell窗口命令行执行如下命令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dism /online /add-package /packagepath:<span class="string">"C:\Windows\servicing\Packages\Adobe-Flash-For-Windows-Package~31bf3856ad364e35~amd64~~10.0.14393.0.mum"</span></span><br></pre></td></tr></table></figure><p>如上命令执行成功后，检查WinSer 2016补丁更新会发现针对Adobe Flash Player安全更新，当前的补丁信息为”2018-适用于 Adobe Flash Player for Windows Server 2016 的 08 安全更新，适用于基于 x64 的系统 (KB4343902)”。</p><p>Windows Server 2019：</p><p>Windows Server 2019中启用flash的方法与2016相似，只不过要把上面命令行中的14393.0改为17763.1，就是在管理员模式的CMD或Powershell窗口命令行执行如下命令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dism /online /add-package /packagepath:<span class="string">"C:\Windows\servicing\Packages\Adobe-Flash-For-Windows-Package~31bf3856ad364e35~amd64~~10.0.17763.1.mum"</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>VMware workstation 不可恢复错误解决</title>
    <link href="https://6-7.xyz/19-11-28.html"/>
    <id>https://6-7.xyz/19-11-28.html</id>
    <published>2019-11-29T05:56:47.000Z</published>
    <updated>2019-11-29T06:07:37.693Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>由于笔记本关机时，仍然在运行VMware里面的系统并没有正常的关机当再次开机时导致出现了如下错误</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/19-11-28/1.png" alt=""></p><p>虚拟机是一种被挂起的状态，无法恢复到当时电脑关机时的状态。</p><h1 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h1><p>到虚拟机安装目录下删除掉一个文件即可</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/19-11-28/2.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
      <category term="VMware" scheme="https://6-7.xyz/tags/VMware/"/>
    
  </entry>
  
  <entry>
    <title>桌面虚拟化</title>
    <link href="https://6-7.xyz/19-11-27.html"/>
    <id>https://6-7.xyz/19-11-27.html</id>
    <published>2019-11-26T14:49:53.000Z</published>
    <updated>2019-11-26T14:52:24.285Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="新建Esxi服务器"><a href="#新建Esxi服务器" class="headerlink" title="新建Esxi服务器"></a>新建Esxi服务器</h1><h1 id="搭建域控服务器"><a href="#搭建域控服务器" class="headerlink" title="搭建域控服务器"></a>搭建域控服务器</h1><h1 id="创建vCenter"><a href="#创建vCenter" class="headerlink" title="创建vCenter"></a>创建vCenter</h1><h1 id="搭建connection-server"><a href="#搭建connection-server" class="headerlink" title="搭建connection server"></a>搭建connection server</h1><h1 id="创建模板机"><a href="#创建模板机" class="headerlink" title="创建模板机"></a>创建模板机</h1><h1 id="测试连接"><a href="#测试连接" class="headerlink" title="测试连接"></a>测试连接</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
      <category term="虚拟化" scheme="https://6-7.xyz/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Esxi挂载iSCSI</title>
    <link href="https://6-7.xyz/19-11-26.html"/>
    <id>https://6-7.xyz/19-11-26.html</id>
    <published>2019-11-26T13:41:13.000Z</published>
    <updated>2019-11-26T14:41:17.757Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>之前曾写过一篇对于Windows挂在iSCSI的文章，在后面的学习中发现Esxi也可以挂载iSCSI。下面主要简单的记录一下基本流程。</p><h1 id="配置openfiler"><a href="#配置openfiler" class="headerlink" title="配置openfiler"></a>配置openfiler</h1><p>在openfiler的web管理界面点击system然后配置Network Access Configuration把Esxi的IP地址添加进去</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/1.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/2.png" alt=""></p><p>然后配置iSCSI  Targets，由于之前已经配置过所以直接修改Network ACL 即可把Esxi主机🖥的IP地址改为allow</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/3.png" alt=""></p><h1 id="配置Esxi"><a href="#配置Esxi" class="headerlink" title="配置Esxi"></a>配置Esxi</h1><p>通过vSphere client连接Esxi服务器，连接成功如下图所示</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/4.png" alt=""></p><p>点击配置然后点击添加存储适配器，选择添加软件iSCSI适配器</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/5.png" alt=""></p><p>添加成功后，会发现多了一个iSCSISoftware Adapter</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/6.png" alt=""></p><p>右键点击属性对其进行配置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/7.png" alt=""></p><p>网络配置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/8.png" alt=""></p><p>设置动态发现</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/9.png" alt=""></p><p>点击右侧的存储然后添加存储</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/10.png" alt=""></p><p>选择Lun创建的数据存储</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/11.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/1.png" alt=""></p><p>后面这里都采取默认设置，可以根据自己需求来进行配置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/12.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/13.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/14.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/15.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/11-26/17.png" alt=""></p><p>到此已经挂载成功，可以对数据存储进行操作。上传下载文件等等</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
      <category term="虚拟化" scheme="https://6-7.xyz/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>vCenter安装问题</title>
    <link href="https://6-7.xyz/19-11-15.html"/>
    <id>https://6-7.xyz/19-11-15.html</id>
    <published>2019-11-15T07:55:02.000Z</published>
    <updated>2019-11-15T09:25:26.444Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在之前安装ESXI是选择采用桥接的方式，选择的是桥接到无线网卡。十分顺利的安装成功了，但是由于桥接这种方法在后来的使用之中发现有点不太方便。主要有以下弊端：</p><p><strong>我们必须连接固定的WiFi网络;虚拟机中或者物理机的IP修改会带来很多麻烦。</strong></p><p>​    当切换所连接的网络之后，自己电脑的IP地址(内网)会发生相应的变化比如我在宿舍中连接的WiFi是在192.168.1.0这个网段下面的；连接自己手机的热点是172.20.10.0网段下面的；连接同学的手机热点是192.168.43.0这个网段下面的。那么在不同的网段下面就需要修改自己物理机win10的IP地址或者虚拟机中ESXI的IP地址。比如上课当所连的WiFi分配的IP地址为192.168.43.0网段下，ESXI还为上次在宿舍设置的桥接IP地址时192.168.1.0网段下面。这时win10是无法ESXI的IP地址用vsphere client或者使用使用浏览器在web端对ESXI进行操作的。可以通过如下两种方法进行访问，但是这两种方法都不是一个很好的方法。如果修改ESXI的IP地址是可以访问ESXI的同时win10也是可以上网。但是这种方法有个弊端，vCenter可以安装在ESXI中也可以安装在Windows server中。问题就出在当它安装在ESXI中时，当我们要想访问它时。我们会通过IP地址账户密码进行访问。但是IP地址遭到了变化不在同一个网段之下的时候是ping不通的，我们也是访问不了的。可是vCenter要想修改IP地址必须访问<a href="http://ip:5480" target="_blank" rel="noopener">http://ip:5480</a> 来进行修改或者使用SSH远程连接vCenter使用相关命令来进行修改。根本无法访问肯定也是没办法修改的。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/1.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/2.png" alt=""></p><p>所以修改ESXI地址在某种情况下是不可取的，通过修改Windows 10IP地址呢是不会出现这么多问题的。But你修改了静态IP地址之后你Windows就没法上网了呀。如果需要查资料什么的用手机查起来并不是很方便，所以说体验起来也不是很友好。😂😂😂</p><p>那么难到就没有一个完美的解决方案嘛</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/11.png" alt=""></p><p>答案是当然是有的，我们可以采用VMware workstation的虚拟网络编辑器添加一个新的网络，并且设置成仅主机模式</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/3.png" alt=""></p><p>虚拟机的网络适配器选项选择使用Vmnet4(仅主机模式)这个网络</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/4.png" alt=""></p><p>然后重启ESXI并且重新安装一个新的vCenter，可是在安装vCenter的过程之中这次并没有那么的顺利了。安装多次出现了奇奇怪怪的错误这里由于当时没截图所以就先不放图了，反正就是无论如何都安装不上要么安装卡死，要么提示安装错误真的狗血。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/8.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/9.png" alt=""></p><p>后面突发奇想既然前面选择桥接安装成功了，那么就先继续使用桥接安装呗。把自己Windows无线网卡的地址设置成在Vmnet4网段下的，这里设置的如下当然可以任意设置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/10.jpg" alt=""></p><p>并且把ESXI的IP地址也设置成此网段下的地址</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/6.png" alt=""></p><p>然后进行安装就完事了最终安装成功后截图如下</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/7.png" alt=""></p><p>到此安装完成之后可以把WiFi的IP地址改成自动获取，或者使用拨号上网来对ESXI以及vCenter进行访问了。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/12.png" alt=""></p><p>这样就再也不用担心上面的问题出现了，可以一边愉快的学习虚拟化，一边愉快的做其他的事情。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vCenter/13.png" alt=""></p><p>目前使用中没发现问题，这样稳的一比！！！😉😉</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
      <category term="虚拟化" scheme="https://6-7.xyz/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Windows server搭建vpn服务实验</title>
    <link href="https://6-7.xyz/vpn.html"/>
    <id>https://6-7.xyz/vpn.html</id>
    <published>2019-11-06T07:13:28.000Z</published>
    <updated>2019-11-07T05:34:08.717Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>虚拟专用网络 VPN（Virtual Private Network）综合利用了密码、数字签名和 PKI 等技术，利用隧道协议，在不安全的公共网络上构建虚拟的专用数据通道，以保证其中数据的机密性和完整性。VPN 是企业网在公共网络上的扩展，可以开辟一条安全的隧道，保证两个端点或者两个局域网之间的安全通信。VPN 通过将因特网虚拟成一台路由器，将物理位置分散的局域网和主机虚拟成一个统一的虚拟企业网，从而保证数据通信的安全性。VPN 综合利用了隧道技术、加密技术、鉴别技术和密钥管理等技术，在公共网络上建立了一个虚拟的安全通道，以实现两个网络或者两台主机之间的安全连接，目前 VPN 主要有两类应用场景，其一是远程访问 VPN 模式，即企业员工从外地访问企业内部网络中的主机，当员工在外出差，需要访问企业内部网络中的机密信息时，为了避免信息传输过程中发生泄密，主机首先以 VPN 客户端的方式连接到企业的远程访问 VPN 服务器，这样远程主机访问内网数据时就会被加密传输，从而保证数据的安全性，如图 2-31 所示，</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/1.jpg" alt=""></p><center><strong>图2-31 远程主机访问企业内网</strong></center><p>其二当一个公司在多个城市设置有分公司时，为了保证企业分公司之间的数据传输安全，在每个局域网的出口处设置VPN 服务器，当局域网之间需要交换信息时，两个 VPN 服务器之间建立一条安全的隧道，保证数据在隧道中安全的传输，这种方式也被称为是网络到网络 VPN，适用于企业各个分支机构，商业合作伙伴之间的网络互连要求，如图 2-32 所示。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/2.jpg" alt=""></p><center><b>图2-32 企业分支机构之间的局域网连通</b></center><p>本例中应用的场景是远程访问 VPN 模式，通过远程计算机访问企业内网的资源，具体实验拓扑图如图 2-33 所示，详细配置信息如表 1-1 所示，具体配置步骤如下：</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/3.jpg" alt=""></p><center><b>图2-33 实验拓扑图</b></center><center><b>表 1-1 网络设备主要功能介绍</b></center><table><thead><tr><th align="left"><strong>网络配置情况</strong></th><th align="left"><strong>电脑设置内容</strong></th></tr></thead><tbody><tr><td align="left"><strong>路由器（windows server 2008 模拟仿真）<br/>VMnet1：<br/>IP 地址：192.168.149.3<br/>子网掩码：255.255.255.0<br/>VMnet2:<br/>IP 地址：192.168.87.3<br/>子网掩码：255.255.255.0</strong></td><td align="left"><strong>1、 完成网络 IP 地址配置；<br/>2、 完成 LAN 路由的设置；</strong></td></tr><tr><td align="left"><strong>VPN 服务器（windows server 2008）<br/>VMnet2:<br/>IP 地址：192.168.87.5<br/>子网掩码：255.255.255.0<br/>默认网关：192.168.87.3<br/>VMnet3：<br/>IP 地址：192.168.171.3<br/>子网掩码：255.255.255.0</strong></td><td align="left"><strong>1、 完成网络 IP 地址配置；<br/>2、完成 VPN 服务器搭建；</strong></td></tr><tr><td align="left"><strong>远程计算机的基本配置情况（XP 操作<br/>系统）<br/>VMnet1:<br/>IP 地址：192.168.149.6<br/>子网掩码：255.255.255.0<br/>默认网关：192.168.149.3</strong></td><td align="left"><strong>1、 完成网络 IP 地址配置；<br/>2、 完成 VPN 客户端安装；<br/>3、 使用客户端拨号连接 VPN 服务器；<br/>4、 使用 PING 命令测试连通性；</strong></td></tr></tbody></table><h1 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h1><h2 id="步骤-1："><a href="#步骤-1：" class="headerlink" title="步骤 1："></a>步骤 1：</h2><p>首先进行的是模拟路由器的配置，使用的是 windows 2008 操作系统来进行模拟设置，首先选择 VMware 菜单栏中的虚拟机选项，选择其中的设置选项，并选择添加，根据要求添加对应的网络适配器，并进行网络 IP 地址的设置，如图 2-34和图2-35 所示(这里不再详细讲如何在虚拟机中安装Windows server 2008)</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/4.jpg" alt=""></p><center><b>图2-34 添加多块网卡</b></center><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/5.jpg" alt=""></p><center><b>图2-35 配置IP地址<b></center><p>windows server 2008默认是没有路由和远程访问这个服务的需要自行添加，具体步骤如下</p><p>点击桌面左下角的服务器管理器，然后点击添加角色</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/6.jpg" alt=""></p><p>选择网络策略和访问服务</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/7.jpg" alt=""></p><p>点击下一步</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/8.jpg" alt=""></p><p>选择为网络策略和访问服务安装的角色服务，即:路由和远程访问服务</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/9.jpg" alt=""></p><p>点击安装</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/10.jpg" alt=""></p><p>安装完成</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/11.jpg" alt=""></p><p>下面选择开始菜单，管理工具，打开路由和远程访问，在其中右键选择配置并启用，进入向导开始进行配置。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/12.jpg" alt=""></p><p>选择自定义配置，单击下一步继续，并按照服务器的功能，选择 LAN 路由器，这样就可以使该服务器实现路由器的功能，完成后系统会要求进行服务配置，同意配置.并且启动服务</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/13.jpg" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/14.jpg" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/15.jpg" alt=""></p><p>配置完成后，将会看到在路由和远程访问中包含 IP 路由选择，其中包括常规和静态路由两个选项，这样模拟的路由器就已经配置完成了</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/16.jpg" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/17.jpg" alt=""></p><h2 id="步骤2："><a href="#步骤2：" class="headerlink" title="步骤2："></a>步骤2：</h2><p>配置 VPN 服务器，首先根据实验要求完成网络适配器的添加，并进行 IP 地址的配置，</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/18.jpg" alt=""></p><p>完成 IP 地址配置后，同样选择管理工具，路由和远程访问，右键选择配置并启用路由和远程访问，并在其中选择远程访问（拨号或 VPN）选项，单击下一步继续</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/19.jpg" alt=""></p><p>分别选择 VPN 和拨号两个选项，单击下一步继续，进行网络接口的选择，在此必须选择的接口是连接外网的接口，在此选择的是本地连接 2，IP 地址是192.168.87.5，单击下一步继续</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/20.jpg" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/21.jpg" alt=""></p><p>分别对 IP 地址指定和多个远程访问服务器设置，完成 VPN 服务器的配置，完成后会自动开启服务</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/22.jpg" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/23.jpg" alt=""></p><p>完成配置后可以在路由和远程访问中了解具体的配置情况</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/24.jpg" alt=""></p><p>为了能让远程计算机能够通过拨号接入到 VPN 服务器，需要首先为远程用户创建一个登录账号，右键我的电脑选择管理，在其中选择本地用户和组，在用户中创建用户 vpn，设置密码，并选择密码永不过期。右键该用户选择属性，在其中选择拨入选项卡，勾选允许访问，单击确定后，完成配置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/25.jpg" alt=""></p><h2 id="步骤-3："><a href="#步骤-3：" class="headerlink" title="步骤 3："></a>步骤 3：</h2><p>最后需要在远程计算机中新建 VPN 客户端，首先按照要求配置 IP 地址，并右键网上邻居选择属性，在其中选择创建一个新的连接，选择连接到我的工作场所的网络，单击下一步继续</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/26.jpg" alt=""></p><p>在网络连接选项页面，选择虚拟专用网络连接，单击下一步继续，输入公司名称，并输入 VPN 服务器的 IP 地址192.168.87.5，选择在我的桌面上添加一个到此连接的快捷方式</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/27.jpg" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/28.jpg" alt=""></p><p>打开拨号连接，输入用户名和密码，在此输入的是用户名是 vpn，密码是 123456，必须跟 VPN 服务器中设置的一致，单击连接后就可以 VPN 拨号连接，连接成功后可以通过 ipconfig /all 命令，查看到本机网络连接情况，可以清晰的看到在原有的网络连接基础上多了一个 PPP 网络连接适配器，获得的地址就是公司内网的 IP 地址</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/29.jpg" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/30.jpg" alt=""></p><p>VPN 拨号使内部 IP 地址获得成功后，可以通过 ping 命令来进行测试，使用 ping 命令测试公司内部的连通性</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/VPN/31.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>虚拟机安装openfiler</title>
    <link href="https://6-7.xyz/openfiler.html"/>
    <id>https://6-7.xyz/openfiler.html</id>
    <published>2019-11-04T06:52:48.000Z</published>
    <updated>2019-11-04T14:29:39.329Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>Openfiler是一个基于rPath Linux系统的免费ISCIS/NAS应用。它是一个基于浏览器的免费网络存储管理实用程序，可以在单一框架中提供基于文件的网络连接存储 (NAS) 和基于块的存储区域网 (SAN)。Openfiler 支持 CIFS、NFS、HTTP/DAV 和 FTP。Openfiler能把标准x86/64架构的系统变成一个强大的NAS、SAN存储和IP存储网关，为管理员提供一个强大的管理平台，并能能应付未来的存储需求。依赖如VMware，Virtual Iron和Xen服务器虚拟化技术，Openfiler也可部署为一个虚拟机实例。<br>Openfiler的主要性能和优点：</p><p>● 可靠性—Openfiler可以支持软件和硬件的RAID，能监测和预警，并且可以做卷的快照和快速恢复。<br>● 高可用性–Openfiler支持主动或被动的高可用性集群、多路径存储（MPIO）、块级别的复制。<br>● 性能–及时更新的Linux内核支持最新的CPU、网络和存储硬件。<br>● 可伸缩性—文件系统可扩展性最高可超出60TB，并能使文件系统大小可以在线的增长。</p><h1 id="openfiler安装"><a href="#openfiler安装" class="headerlink" title="openfiler安装"></a>openfiler安装</h1><h2 id="下载openfiler镜像"><a href="#下载openfiler镜像" class="headerlink" title="下载openfiler镜像"></a>下载openfiler镜像</h2><p><a href="https://www.openfiler.com/community/download" target="_blank" rel="noopener">链接🔗</a></p><h2 id="创建虚拟机"><a href="#创建虚拟机" class="headerlink" title="创建虚拟机"></a>创建虚拟机</h2><p>新建虚拟机，选择自定义</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/0.png" alt=""></p><p>选择虚拟机兼容性</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/1.png" alt=""></p><p>选择稍后安装操作系统</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/2.png" alt=""></p><p>选择系统为Linux并且选择为Red Hat Enterprise Linux 5</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/3.png" alt=""></p><p>命名虚拟机并且选择安装位置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/4.png" alt=""></p><p>处理器配置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/5.png" alt=""></p><p>虚拟机内存设置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/6.png" alt=""></p><p>设置网络类型，选择桥接</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/7.png" alt=""></p><p>选择I/O控制器类型</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/8.png" alt=""></p><p>选择磁盘类型</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/9.png" alt=""></p><p>选择磁盘</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/10.png" alt=""></p><p>指定磁盘容量</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/11.png" alt=""></p><p>指定磁盘文件</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/12.png" alt=""></p><p>选择挂载安装镜像</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/13.png" alt=""></p><p>开启虚拟机，进入此界面按回车</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/14.png" alt=""></p><p>点击下一步</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/15.png" alt=""></p><p>选择适当的键盘</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/16.png" alt=""></p><p>初始化磁盘，选择”Yes”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/17.png" alt=""></p><p>创建分区，选择”Yes”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/18.png" alt=""></p><p>选择使用静态的IP地址</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/19.png" alt=""></p><p>配置网关与DNS服务器地址，这一步使用内网地址的话感觉DNS服务器配置与否都行。所以此处有点多余2333🤣</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/20.png" alt=""></p><p>选择时区，选择上海</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/21.png" alt=""></p><p>设置root密码</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/22.png" alt=""></p><p>点击“Next”进行安装</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/23.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/24.png" alt=""></p><p>安装完成，选择“Reboot”重启系统</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/25.png" alt=""></p><h2 id="配置openfiler-的iscsi目标服务器"><a href="#配置openfiler-的iscsi目标服务器" class="headerlink" title="配置openfiler 的iscsi目标服务器"></a><strong>配置openfiler 的iscsi目标服务器</strong></h2><h3 id="1-重启进入操作系统"><a href="#1-重启进入操作系统" class="headerlink" title="1.重启进入操作系统"></a><strong>1.重启进入操作系统</strong></h3><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/26.png" alt=""></p><h3 id="2-添加3块scsi硬盘"><a href="#2-添加3块scsi硬盘" class="headerlink" title="2.添加3块scsi硬盘"></a><strong>2.添加3块scsi硬盘</strong></h3><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/27.png" alt=""></p><p>然后输入<code>init 6</code>重启操作系统，重新扫描scsi硬盘。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/28.png" alt=""></p><h3 id="3-登录web界面"><a href="#3-登录web界面" class="headerlink" title="3.登录web界面"></a><strong>3.登录web界面</strong></h3><p>登录地址就是启动时页面上显示的IP地址;用户名是：openfiler ， 密码是：password</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/29.png" alt=""></p><h3 id="4-磁盘配置RAID5"><a href="#4-磁盘配置RAID5" class="headerlink" title="4.磁盘配置RAID5"></a><strong>4.磁盘配置RAID5</strong></h3><p>登录成功后界面如下所示</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/30.png" alt=""></p><p>选择”Volumes”选项</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/31.png" alt=""></p><p>选择右测得菜单栏“Block Devices”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/32.png" alt=""></p><p>点击刚添加的三块硬盘</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/33.png" alt=""></p><p>创建raid分区类型</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/34.png" alt=""></p><p>选择右侧的“Software RAID”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/35.png" alt=""></p><p>选择创建RAID5分区，点击“Add array”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/36.png" alt=""></p><h3 id="5-创建逻辑卷"><a href="#5-创建逻辑卷" class="headerlink" title="5.创建逻辑卷"></a><strong>5.创建逻辑卷</strong></h3><p>使用刚才创建好的raid5分区创建逻辑卷，点击“Volume Groups”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/37.png" alt=""></p><p>点击“create new physical volumes”，给卷组起一个名字叫“First”，选择物理卷“/dev/md0”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/38.png" alt=""></p><p>点击右侧的“Add volume”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/39.png" alt=""></p><p>创建卷，卷的名字叫“One”，卷描述“hello world”当然可以填其他的，容量调整为最大，FileSystem / Volume type： 选择 block(iSCSI,FC,etc)</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/40.png" alt=""></p><h3 id="6-启动iscsi目标服务器"><a href="#6-启动iscsi目标服务器" class="headerlink" title="6.启动iscsi目标服务器"></a><strong>6.启动iscsi目标服务器</strong></h3><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/41.png" alt=""></p><h3 id="7-配置访问控制列表，iscsi目标服务器"><a href="#7-配置访问控制列表，iscsi目标服务器" class="headerlink" title="7.配置访问控制列表，iscsi目标服务器"></a><strong>7.配置访问控制列表，iscsi目标服务器</strong></h3><p>选择“System”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/42.png" alt=""></p><p>选择允许访问的ip地址或一个网段，然后点击“update”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/43.png" alt=""></p><p>选择Volumes</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/44.png" alt=""></p><p>选择右边的“iSCSI Targets”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/45.png" alt=""></p><p>添加一个target IQN</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/46.png" alt=""></p><p>选择“LUN Mapping”，然后进行映射</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/47.png" alt=""></p><p>选择“Network ACL”，“ACCESS”下面改成“Allow”，然后点击“update”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/48.png" alt=""></p><h2 id="连接iscsi测试"><a href="#连接iscsi测试" class="headerlink" title="连接iscsi测试"></a><strong>连接iscsi测试</strong></h2><p>打开iscsi发起程序，连接iscsi目标服务器</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/49.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/50.png" alt=""></p><p>查看Windows磁盘管理，发现已经正常连接</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/51.png" alt=""></p><p>新建一个分区</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/52.png" alt=""></p><p>复制文件速度测试</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/openfiler/53.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
      <category term="Linux" scheme="https://6-7.xyz/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>虚拟化VMware ESXi 6.7服务器与vCenter的安装与配置</title>
    <link href="https://6-7.xyz/vsphere.html"/>
    <id>https://6-7.xyz/vsphere.html</id>
    <published>2019-10-08T11:13:16.000Z</published>
    <updated>2019-10-28T15:07:04.905Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/desktop.jpg" alt="首页"></p><a id="more"></a><h1 id="vSphere虚拟化架构"><a href="#vSphere虚拟化架构" class="headerlink" title="vSphere虚拟化架构"></a>vSphere虚拟化架构</h1><p>vSphere是VNware公司在2001年基于云计算推出的一套企业级虚拟化解决方案、核心组件为ESXi。如今，经历了5个版本的改进，已经实现了虚拟化基础架构、高可用性、集中管理、性能监控等一体化解决方案。</p><p><a href="https://baike.baidu.com/item/vSphere" target="_blank" rel="noopener">🔗详情点击</a></p><h2 id="虚拟机的好处"><a href="#虚拟机的好处" class="headerlink" title="虚拟机的好处"></a>虚拟机的好处</h2><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/1.png" alt="img"></p><h2 id="为什么要使用虚拟机："><a href="#为什么要使用虚拟机：" class="headerlink" title="为什么要使用虚拟机："></a>为什么要使用虚拟机：</h2><p>　　<strong>物理架构存在的问题：</strong></p><ul><li>　　难以复制和移动</li><li>　　受制于一定的硬件组件</li><li>　　生命周期短</li><li>　　物理服务器的资源利用率低</li></ul><p>　　<strong>服务器虚拟化</strong><br>　　<strong>虚拟机与物理机相比</strong></p><ul><li>　　最大化利用物理机的资源，节省能耗</li><li>　　更方便地获取计算资源</li><li>　　硬件无关。虚机都是文件，方便迁移、保护</li><li>　　生命周期更长，不会随着硬件变化而变化</li><li>　　根据需求的变化，非常容易更改资源的分配</li><li>　　更多高级功能</li></ul><p>　　在线的数据、虚拟机迁移<br>　　高可用<br>　　自动资源调配<br>　　云计算</p><h2 id="vSphere基础物理架构"><a href="#vSphere基础物理架构" class="headerlink" title="vSphere基础物理架构"></a>vSphere基础物理架构</h2><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/2.png" alt="img"></p><p>　　虚拟化服务器：又称x86服务器，可以由多个ESXi组成，通过网络服务提供CPU和内存资源，所有的虚拟机运行在该服务器中。<br>存储网络：用于存储所有的虚拟化数据，虚拟机的性能也与之息息相关。存储网络可以使用SAN、NAS等存储技术。</p><h2 id="vSphere基本架构"><a href="#vSphere基本架构" class="headerlink" title="vSphere基本架构"></a>vSphere基本架构</h2><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/3.png" alt="vmware"></p><p>1.架构服务<br>Infrastructure Service(架构服务)定义了 Computer、 Storage、 Network等三大部分<br>(1)计算机<br>计算机主要包括ESX和ESXi( vSphere5.0中仅有ESXI)、DRS(分布式资源调配)以及<br>Memory(内存)。<br>①ESX/ESXi<br>ESXI是在物理服务器上安装虚拟化管理服务用于管理底层硬件资源。安装ESXi的物理服务<br>器称为ESXi主机。是 Sphere虚拟化架构的基础。<br>②DRS<br>DRS(分布式资源调配)是 Sphere高级特性之一,动态调配虚拟机运行的ESXI主机,充分<br>利用物理服务器硬件资源。<br>③内存<br>Memory(内存)就是物理服务器以及虚拟机内存的管理。<br>(2)存储<br>Storage (存储)主要包括了VMFS、 Thin Provisioning、 Storage I/O Control。<br>VMFS (虚拟机文件系统)是跨越多个物理服务器实现虚拟化的基础。<br>Thin Provisioning (精简盘)是对虚拟机硬盘文件VMDK动态调配的技术。<br>Storage I/O Control(存储读写控制)是 vSphere高级特性之一,利用对存储读写的控制是存储达到更好的性能。<br>(3)网络<br>Network包括了 Distributed Switch、 Network I/O Control<br>Distributed Switch (分布式交换机)是Sphere虚拟化架构网络核心之一,是跨越多台ESXI主机的虚拟交换机。</p><p>Network I/O Control(网络读写控制)是 vSphere高级特性之一,通过对网络读写的控制使网络达到更好的性能。<br>2应用服务<br>Application Service(应用服务)定义了 Availability、Security、Scalability等三大部分。<br>(1)可用性<br>Availability (可 用 性)包括了 vMation、Storage vMotion、High Availability、 Fault Tolerance、 Data Recovery。<br>①实时迁移<br>vMotion(实时迁移)是让运行在ESXi主机上的虚拟机可以在开机或关机状态下迁移到另外的ESXI主机上。<br>②存储实时迁移<br>Sterage vMotion(存储实时迁移)是让虚拟机所使用的存储文件在开机或关机状态下迁移到另的存储设备上。<br>③高可用性<br>High Availability(高可用性)是在ESXi主机出现故障的情况下,将虚拟机迁移到正常的ESXi主机运行,尽量避免由于ESXi主机故障而导致服务中断。<br>④容错<br>Fault Tolerance(容错)是让虚拟机同时在两台ESX主机上以主/从方式并发地运行,也就是所谓的虚拟机双机热备。当任意一台虚拟机出现故障,另外一台立即接替工作,对于用户而言感觉不到后台已经发生了故障切换。<br>⑤数据恢复<br>Data Recovery(数据恢复)是通过合理的备份机制对虚拟机进行备份,以便故障发生时能够快速恢复。<br>(2)安全性<br>Security包括 vShield Zones、 VMsafe。<br>vShield Zones是一种安全性虚拟工具,可用于显示和实施网络活动。<br>VMsafe安全API使第三方安全厂商可以在管理程序内部保护虚拟机。<br>(3)扩展性<br>Scalability括DRS、Hot Add。<br>①DRS<br>DRS(分布式资源调配)是 vSphere高级特性之一,动态调配虚拟机运行的ESXi主机,充分利用物理服务器硬件资源。<br>②热插拔<br>Hot Add(热拔插)使虚拟机能够在不关机的情况下增加CPU、内存、硬盘等</p><p>3.vCenter Server<br>vSphere虚拟化架构的核心管理工具也是日常管理操作平台。vSphere虎拟化<br>性都必须依靠 vCenter Server实现,利用 vCenter Server可以集中管理多个ESXI主机及其虚拟机<br>4.虚拟机<br>Virtual Machine(虚拟机)对于用户来说,实际就是一台物理机,和物理机一样拥有CPU、内存、硬盘等硬件资源,安装操作系统以及应用程序后与物理服务器提供的服务完全一样。<br>5.私有云资源池/公有云<br>Private Cloud Resource Pool  (私有云资源池)由硬件资源组成，通过vSphere管理私有云所有资源。</p><p>Public Cloud(公有云)私有云的延伸，可向外部提供云计算服务。</p><h1 id="Esxi"><a href="#Esxi" class="headerlink" title="Esxi"></a>Esxi</h1><p>ESXi专为运行虚拟机、最大限度降低配置要求和简化部署而设计。只需几分钟时间，客户便可完成从安装到运行虚拟机的全过程，特别是在下载并安装预配置虚拟设备的时候。</p><p>在VMware Virtual Appliance Marketplace 上有800多款为VMware hypervisor 创建的虚拟设备，如今，ESXi已经实现了与Virtual Appliance Marketplace的直接整合，使用户能够即刻下载并运行虚拟设备。这为即插即用型软件的交付与安装提供了一种全新和极其简化的方式。</p><p><a href="https://baike.baidu.com/item/ESXi" target="_blank" rel="noopener">🔗详情点击</a></p><h2 id="安装Esxi服务器"><a href="#安装Esxi服务器" class="headerlink" title="安装Esxi服务器"></a>安装Esxi服务器</h2><p>由于种种原因无法在物理机完成操作，只好使用VMware workstation来安装Esxi。</p><p>使用的虚拟机是<a href="https://pan.baidu.com/s/1lbPFwUlxvoNkzyl2jQjPPQ" target="_blank" rel="noopener">VMware 15</a> </p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/1.jpg" alt="百度云链接"></p><h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><p>首先打开VMware workstation软件创建新的虚拟机并且采用自定义安装</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj.png" alt="新建虚拟机"></p><p>选择稍后安装一个操作系统</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj2.png" alt="新建虚拟机"></p><p>选择操作系统，点击VMware ESX选择版本为VMware ESXI 6.x的那个版本</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj3.png" alt="新建虚拟机"></p><p>命名虚拟机名称并且选择虚拟机在自己电脑上的位置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj4.png" alt="新建虚拟机"></p><p>选择处理器的配置，这里可以根据自己的需求选择</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj5.png" alt="新建虚拟机"></p><p>选择网络类型，这里使用桥接网络</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj7.png" alt="新建虚拟机"></p><p>选择I/O控制器类型，选择为推荐的准虚拟化SCSI</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj8.png" alt="新建虚拟机"></p><p>选择虚拟磁盘类型为SCSI</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj9.png" alt="新建虚拟机"></p><p>选择创建新的虚拟磁盘</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj10.png" alt="新建虚拟机"></p><p>指定虚拟磁盘的容量大小，在这分配200GB空间具体根据自己需求</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj11.png" alt="新建虚拟机"></p><p>先不要点击完成，因为ESXI的镜像还没有挂载，点击自定义硬件</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj12.png" alt="新建虚拟机"></p><p>选择挂载自己电脑上的ISO镜像文件</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/xj13.png" alt="新建虚拟机"></p><p>选择完成后点击关闭然后再点击完成，然后打开虚拟机。会出现如下的界面</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az1.png" alt="新建虚拟机"></p><p>等待片刻，按回车键开始安装</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az2.png" alt="新建虚拟机"></p><p>按F11键接受协议并继续</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az3.png" alt="新建虚拟机"></p><p>选择安装的位置并按回车键继续安装</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az4.png" alt="新建虚拟机"></p><p>选择键盘布局，这里选择使用默认.</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az5.png" alt="新建虚拟机"></p><p>为root用户创建密码，需要选择安全性较高的的数字字母字符组合来作为密码</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az6.png" alt="新建虚拟机"></p><p>按下F11键开始正式的安装</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az7.png" alt="新建虚拟机"></p><p>接下来会进入这个安装进度界面，</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az8.png" alt="新建虚拟机"></p><p>等待2-3分钟后，安装完成按回车键重启系统</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/az9.png" alt="新建虚拟机"></p><p>重启完成后界面如下</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/jm.png" alt="新建虚拟机"></p><p>对系统进行配置，按F2键然后输入刚才创建的密码进入配置界面。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/jm1.png" alt="新建虚拟机"></p><p>Configure Managment Network来配置网络。配置静态IPV4地址</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/jm2.png" alt="新建虚拟机"></p><p>配置DNS服务器地址</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/jm3.png" alt="新建虚拟机"></p><p>按ESC键离开，会提示下面这个界面按Y同意重启网络</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/jm4.png" alt="新建虚拟机"></p><p>Troubleshooting Options来开启SSH与Shell</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/jm5.png" alt="新建虚拟机"></p><p>到此为止配置上基本完成了，下面在浏览器地址栏中输入刚才配置的IP地址<code>192.168.1.103</code>使用web界面对ESXI进行控制。使用root用户登录</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/jm6.png" alt="新建虚拟机"></p><h1 id="vCenter"><a href="#vCenter" class="headerlink" title="vCenter"></a>vCenter</h1><p>Vcenter一般指 VMware vCenter™ Server<br>VMware vCenterServer 提供了一个可伸缩、可扩展的平台，为 虚拟化管理奠定了基础。 VMware vCenter Server（以前称为 VMware VirtualCenter），可集中管理 VMware vSphere 环境，与其他管理平台相比，极大地提高了 IT 管理员对虚拟环境的控制。<br>VMware vCenter Server：提高在虚拟基础架构每个级别上的集中控制和可见性，通过主动管理发挥 vSphere 潜能，是一个具有广泛合作伙伴体系支持的可伸缩、可扩展平台。</p><p><a href="https://baike.baidu.com/item/vCenter" target="_blank" rel="noopener">🔗详情点击</a></p><h2 id="安装vCenter"><a href="#安装vCenter" class="headerlink" title="安装vCenter"></a>安装vCenter</h2><p>vCenter主要有两种:一种是基于Windows的vCenter server它的功能和性能更强大！还有一种就是基于嵌入式linux的vCenter server appliance，使用小的虚拟化环境（主机小于50台，虚拟机少于1000个），使用这个部署起来更简单快捷。当然如果更大的虚拟化环境，就一定需要基于Windows的vCenter server了。随着版本的更迭，vmware去windows化越来越明显了，很多高级功能（跨集群迁移，vcsa ha等等）只有以vcsa方式部署才可能实现了，vcsa部署维护都要比传统windows+vCenterServer+MySQL方便，就是web管理界面还是不如原来的vsphere client好用。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter.png" alt="vcenter"></p><h3 id="安装vCenter-server-appliance"><a href="#安装vCenter-server-appliance" class="headerlink" title="安装vCenter server appliance"></a>安装vCenter server appliance</h3><p>在Windows上装载镜像</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter1.png" alt="vcenter"></p><p>然后打开vcsa-ui-installer那个文件夹，在打开下面的那个win32目录，双击installer.exe即可开始安装。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter2.png" alt="vcenter"></p><p>安装分为两个阶段</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter3.png" alt="vcenter"></p><p>勾选“我接受许可协议条款”</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter4.png" alt="vcenter"></p><p>选择嵌入式 <strong>Platform Services Controller</strong></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter5.png" alt="vcenter"></p><p>指定VCSA 6.7部署到ESXi主机或vCenter Server</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter6.png" alt="vcenter"></p><p>会出现警告直接点是即可，下面配置VCSA 6.7虚拟机名称以及root密码。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter7.png" alt="vcenter"></p><p>选择部署大小</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter8.png" alt="vcenter"></p><p>选择VCSA 6.7虚拟机存储</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter9.png" alt="vcenter"></p><p>之前的设置部署大小为300GB，可是由于自己电脑没有那么大的存储空间23333。只好这样先装了</p><p>配置VCSA 6.7虚拟机网络</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter10.png" alt="vcenter"></p><p>确认第1阶段参数</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter11.png" alt="vcenter"></p><p>开始第一阶段部署，部署的时间取决于物理服务器性能</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter12.png" alt="vcenter"></p><p>第一阶段完成，开始第二阶段</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter13.png" alt="vcenter"></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter14.png" alt="vcenter"></p><p>配置系统时间</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter15.png" alt="vcenter"></p><p>这里选择跟ESXI主机同步。当然也可以选择和NTP服务器时间相同。根据自己需求选择是否启用SSH</p><p>SSO配置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter16.png" alt="vcenter"></p><p>确认是否加入CEIP</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter17.png" alt="vcenter"></p><p>确认参数</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter18.png" alt="vcenter"></p><p>点击确定开始第二阶段部署</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter19.png" alt="vcenter"></p><p>开始部署</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter20.png" alt="vcenter"></p><p>安装完成</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter21.png" alt="vcenter"></p><p>打开VCSA 6.7控制台界面</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter22.png" alt="vcenter"></p><p>在浏览器中输入VCSA 6.7的IP地址进行访问，VCSA 6.7提供H5以及FLASH两个选择，从初步使用看，H5功能比VCSA 6.5得到增强</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter23.png" alt="vcenter"></p><p>输入SSO登录</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter24.png" alt="vcenter"></p><p>VCSA 6.7 登录成功后界面如下</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter25.png" alt="vcenter"></p><p>访问VMware vCenter Server Appliance Web</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter26.png" alt="vcenter"></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vcenter27.png" alt="vcenter"></p><h3 id="安装vCenter-server"><a href="#安装vCenter-server" class="headerlink" title="安装vCenter server"></a>安装vCenter server</h3><p>当镜像挂载之后打开安装程序</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc1.png" alt="vcenter"></p><p>点击下一步继续安装</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc2.png" alt="vcenter"></p><p>选择接受许可协议条款</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc3.png" alt="vcenter"></p><p>选择部署类型，在这先暂时选择嵌入式部署。在以后会对外部部署进行安装。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc4.png" alt="vcenter"></p><p>配置系统网络名称，输入windows server的IP地址</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc5.png" alt="vcenter"></p><p>vCenter Single Sign-On 配置</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc6.png" alt="vcenter"></p><p>选择vCenter Server服务账户</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc7.png" alt="vcenter"></p><p>数据库设置，选择嵌入式数据库</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc8.png" alt="vcenter"></p><p>配置端口</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc9.png" alt="vcenter"></p><p>选择安装目录</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc10.png" alt="vcenter"></p><p>加入客户体验提升计划</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc11.png" alt="vcenter"></p><p>点击完成开始安装</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc12.png" alt="vcenter"></p><p>安装过程时间根据机器性能决定，大概10分钟左右</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc13.png" alt="vcenter"></p><p>安装完成</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc14.png" alt="vcenter"></p><p>在客户机访问vSphere Web Client</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc15.png" alt="vcenter"></p><p>输入刚才设置的账号密码，然后登录成功</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/vc16.png" alt="vcenter"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vsphere/desktop.jpg&quot; alt=&quot;首页&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="虚拟化" scheme="https://6-7.xyz/categories/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
      <category term="Vmware" scheme="https://6-7.xyz/categories/%E8%99%9A%E6%8B%9F%E5%8C%96/Vmware/"/>
    
    
      <category term="虚拟化" scheme="https://6-7.xyz/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
      <category term="Vmware" scheme="https://6-7.xyz/tags/Vmware/"/>
    
  </entry>
  
  <entry>
    <title>Coding Pages申请SSL/TLS证书错误</title>
    <link href="https://6-7.xyz/ssl.html"/>
    <id>https://6-7.xyz/ssl.html</id>
    <published>2019-07-07T05:46:13.000Z</published>
    <updated>2019-11-07T06:02:18.778Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>博客是托管在coding与github上的，分别开启了https。但是Coding Pages提供的SSL/TLS证书，每次申请成功后有效期是三个月，证书到期后可以继续免费申请。但是当我登陆进入Coding Pages服务的后台并点击重新申请证书时，竟然报错了！！报错信息如下</p><blockquote><p>urn:acme:error:unauthorized:Invalid response from <a href="http://exmaple.com/.well-known/acme-challenge/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" target="_blank" rel="noopener">http://exmaple.com/.well-known/acme-challenge/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</a>: xxxxxxxxx</p></blockquote><p>一时不知如何解决，无奈😔只能百度。找到了官方的帮助文档<a href="https://dev.tencent.com/help/doc/faq/coding-pages/ssh/tls" target="_blank" rel="noopener">链接🔗</a><br>里面有十分详细的说明，按照官方文档最终找到了解决方案</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">错误原因：无法获取正确的域名验证信息</span><br><span class="line">解决方式1：检查 DNS 的 CNAME 记录是否设置正确，静态 Pages 为 &lt;username&gt;.coding.me，动态 Pages 为 &lt;space_key&gt;.coding.io</span><br><span class="line">解决方式2：检查域名的 DNS 是否将海外线路解析到 Coding Pages 的服务器</span><br></pre></td></tr></table></figure><p>显然是因为第二种原因才导致的报错，因为自己也把域名解析到了Github Pages。</p><p><strong>解决方法</strong>：先暂停掉对境外线路的解析，再去Coding Pages界面开启https，成功后再开启对境外线路的解析。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>启动docker WARNING IPv4 forwarding is disabled.解决方法</title>
    <link href="https://6-7.xyz/%F0%9F%90%8B.html"/>
    <id>https://6-7.xyz/🐋.html</id>
    <published>2019-06-11T08:21:51.000Z</published>
    <updated>2019-06-11T15:09:29.458Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/docker/mountain.jpg" height="300px"><a id="more"></a><p>近期在云服务器上体验了一把Docker容器，但是在测试时出现了如下所示的问题。<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/docker/1.png"><br>刚开始以为⚠警告并没有什么大的问题，但是在通过IP地址访问tomcat那个页面的时候怎么也看不到应有的页面。然后通过仔细看了一警告后发现<br>IPv4转发被禁用，网络无法正常工作。所以必须编辑一下<code>/usr/lib/sysctl.d/00-system.conf</code>这个文件往里面加入<code>net.ipv4.ip_forward=1</code>才行。然后需要<code>systemctl restart network &amp;&amp; systemctl restart docker</code>重启网络和Docker.最终测试结果如下所示<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/docker/2.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;img src=&quot;https://b-l.oss-cn-hongkong.aliyuncs.com/photos/docker/mountain.jpg&quot; height=&quot;300px&quot;&gt;
    
    </summary>
    
    
      <category term="Docker" scheme="https://6-7.xyz/categories/Docker/"/>
    
    
      <category term="Docker" scheme="https://6-7.xyz/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>一个很(⊙﹏⊙)的问题</title>
    <link href="https://6-7.xyz/su.html"/>
    <id>https://6-7.xyz/su.html</id>
    <published>2019-06-05T06:15:18.000Z</published>
    <updated>2019-06-05T08:06:58.424Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/1.png" alagin="center"><p>最近给自己的Linux终端做了一个美化，使用的是<code>oh-my-zsh</code>，并且用<code>chsh -s /bin/zsh</code>命令把zsh改成了登录root时使用的shell。但是自己手贱不小心直接把安装的zsh给卸载了🤣。然后就遇到了无法登录root用户的这个问题……<a id="more"></a></p><p>这个提示的是找不到<code>/bin/zsh</code>这个文件或者目录。🦑由于是卸载了的所以肯定找不到的。对于这个问题想的是直接用<code>chsh /bin/zsh</code>把他改回来。但是呢这个修改的也仅仅只是限定于修改当前登录的用户，现在也就是只能修改普通用户的shell，root用户没有登录是无法所以是不行的。使用<code>cat /etc/passwd</code>查看了一下相关文件。</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/2.png"><p>必须把root用户登录的shell改成其他的才行。这里我竟然会想到使用<code>vim /etc/passwd</code>命令来修改，但是对于普通用户来说那个文件只是可读的无法做修改。</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/3.png"><p>那加个sudo呢？使用<code>sudo vim /etc/passwd</code>还是不行的。</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/4.png"><p>这个必须做对<code>/etc/sudoers</code>做相关修改才行，而且这个要修改也就有涉及到登录root用户的问题这个更不用想了。</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/cat.jpg"><p>对于这个问题最后是这么处理的，重启服务器来到启动菜单，出现以下字样立刻按ESC键来到启动菜单。</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/6.png"><p>然后按esc键来到下面这个界面</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/5.png"><p>输入a然后会进入这个界面<img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/7.png"></p><p>输入<code>init=/bin/sh</code>后按回车进入另外一个界面<img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/8.png"></p><p>然后输入<code>mount –orw,remount /</code>,以读写的方式重新挂载分区，然后在使用<code>vim /etc/passwd</code>命令来修改配置文件</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/9.png">，修改成<code>/bin/bash</code>然后保存退出。重启系统然后就可以登录root用户了😂</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/ku.png">]]></content>
    
    <summary type="html">
    
      &lt;img src=&quot;https://b-l.oss-cn-hongkong.aliyuncs.com/photos/su/1.png&quot; alagin=&quot;center&quot;&gt;

&lt;p&gt;最近给自己的Linux终端做了一个美化，使用的是&lt;code&gt;oh-my-zsh&lt;/code&gt;，并且用&lt;code&gt;chsh -s /bin/zsh&lt;/code&gt;命令把zsh改成了登录root时使用的shell。但是自己手贱不小心直接把安装的zsh给卸载了🤣。然后就遇到了无法登录root用户的这个问题……
    
    </summary>
    
    
      <category term="Linux" scheme="https://6-7.xyz/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://6-7.xyz/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ACL</title>
    <link href="https://6-7.xyz/ACL.html"/>
    <id>https://6-7.xyz/ACL.html</id>
    <published>2019-05-29T12:16:38.000Z</published>
    <updated>2019-05-30T16:04:50.990Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/banner.png" width="80%">访问控制列表（Access Control List，ACL） 是路由器和交换机接口的指令列表，用来控制端口进出的数据包。ACL适用于所有的被路由协议，如IP、IPX、AppleTalk等。ACL可以过滤网络中的流量，是控制访问的一种网络技术手段。ACL是物联网中保障系统安全性的重要技术，在设备硬件层安全基础上，通过对在软件层面对设备间通信进行访问控制，使用可编程方法指定访问规则，防止非法设备破坏系统安全，非法获取系统数据。<a id="more"></a><p>此篇博客主要讲ACL的一些基础配置，以及两个有关于自己平时学习上有关于ACL的综合实验。</p><h1 id="ACL基础知识"><a href="#ACL基础知识" class="headerlink" title="ACL基础知识"></a>ACL基础知识</h1><h1 id="ACL综合实验"><a href="#ACL综合实验" class="headerlink" title="ACL综合实验"></a>ACL综合实验</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/Topology1.jpg"><p><strong>实验要求</strong>：某公司有一台三层交换机，公司的服务器、部门A、部门B的用户都连接到这台交换机上，并有以下规定：</p><ol><li>完成PC、服务器、交换机、路由器的基础配置（包括接口地址、vlan划分、静态或者动态路由等）</li><li>部门A和部门B的用户不允许访问FTP服务器和VOD服务器，但可以随时访问Mail服务器。</li><li>内部用户可以通过代理192.168.3.100（提示：路由器R0的下接口地址）访问Internet，但不允许部门A的用户访问Internet。（路由器router0上方的网络模拟为外网Internet）</li><li>部门A和部门B的总经理（IP地址分别为192.168.1.100和192.168.2.100）可以访问Internet和所有服务器。<blockquote><p>提示：cisco 访问控制列表建立与规则书写的格式如下：<br>access-list 表号 permit（deny） 协议 源地址 目的地址 运算符 端口号<br>在接口下应用ACL的指令如下：<br>Ip access-group 表号 out (in)</p></blockquote></li></ol><p><span id="inline-blue">注意</span>此实验二层交换机不需要做配置<br>配置三层交换机<code>S1</code></p><blockquote><p>Switch&gt;<br>Switch&gt;en<br>Switch#conf t<br>Switch(config)#vlan 2<br>Switch(config-vlan)#exit<br>Switch(config)#vlan 3<br>Switch(config-vlan)#exit<br>Switch(config)#vlan 4<br>Switch(config-vlan)#exit<br>Switch(config)#int fa 0/1<br>Switch(config-if)#sw acc vlan 1<br>Switch(config-if)#exit<br>Switch(config)#int fa 0/2<br>Switch(config-if)#sw acc vlan 2<br>Switch(config-if)#exit<br>Switch(config)#int fa 0/3<br>Switch(config-if)#sw acc vlan 3<br>Switch(config-if)#exit<br>Switch(config)#int fa 0/4<br>Switch(config-if)#sw acc vlan 4<br>Switch(config-if)#exit<br>Switch(config)#int vlan 1<br>Switch(config-if)#ip add 192.168.1.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#int vlan 2<br>Switch(config-if)#ip add 192.168.2.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#int vlan 3<br>Switch(config-if)#ip add 192.168.3.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#int vlan 4<br>Switch(config-if)#ip add 192.168.4.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#ip routing<br>Switch(config)#router rip<br>Switch(config-router)#network 192.168.1.0<br>Switch(config-router)#network 192.168.2.0<br>Switch(config-router)#network 192.168.3.0<br>Switch(config-router)#network 192.168.4.0<br>Switch(config-router)#version 2<br>Switch(config)#ip access-list extended 100<br>Switch(config-ext-nacl)#permit ip host 192.168.1.100 any<br>Switch(config-ext-nacl)#deny ip 192.168.1.100 0.0.0.255 host 192.168.4.60<br>Switch(config-ext-nacl)#deny ip 192.168.1.100 0.0.0.255 host 192.168.4.70<br>Switch(config-ext-nacl)#deny ip 192.168.1.100 0.0.0.255 host 192.168.3.100<br>Switch(config-ext-nacl)#permit ip any any<br>Switch(config-ext-nacl)#int vlan 1<br>Switch(config-if)#ip access-group 100 in<br>Switch(config-if)#ip access-list extended 101<br>Switch(config-ext-nacl)#permit ip host 192.168.2.100 any<br>Switch(config-ext-nacl)#deny ip 192.168.2.100 0.0.0.255 host 192.168.4.60<br>Switch(config-ext-nacl)#deny ip 192.168.2.100 0.0.0.255 host 192.168.4.70<br>Switch(config-ext-nacl)#permit ip any any<br>Switch(config-ext-nacl)#int vlan 2<br>Switch(config-if)#ip access-group 101 in</p></blockquote><p>配置路由器<code>R1</code></p><blockquote><p>Router&gt;en<br>Router#conf t<br>Router(config)#int fa 0/0<br>Router(config-if)#ip add 192.168.3.100 255.255.255.0<br>Router(config-if)#no shutdown<br>Router(config-if)#exit<br>Router(config)#int fa 0/1<br>Router(config-if)#ip add 192.168.5.1 255.255.255.0<br>Router(config-if)#no shutdown<br>Router(config)#router rip<br>Router(config-router)#network 192.168.3.0<br>Router(config-router)#network 192.168.5.0<br>Router(config-router)#version 2</p></blockquote><p>结果验证<br>部门A经理上网—可以上网<br>Ping 192.168.3.100<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/A.png"><br>部门A经理访问Mail、FTP、VOD服务器—可以访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/B.png"><br>部门A用户上网—不能上网<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/C.png"><br>部门A用户访问Mail服务器—可以访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/D.png"><br>部门A用户访问FTP服务器和VOD服务器—不能访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/E.png"><br>部门B经理上网—可以上网<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/F.png"><br>部门B经理访问FTP、Mail、VOD服务器—可以访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/G.png"><br>部门B用户上网—可以上网<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/H.png"><br>部门B用户访问Mail服务器—可以访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/I.png"><br>部门B用户访问FTP服务器和VOD服务器—不能访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/J.png"></p><h1 id="ospf及ACL综合实验"><a href="#ospf及ACL综合实验" class="headerlink" title="ospf及ACL综合实验"></a>ospf及ACL综合实验</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/Topology2.jpg"><blockquote><p>实验要求：</p></blockquote><ol><li>S2、S3均是三层交换机，要求把PC1和PC2的网关配置在S3上，Server的网关配置在R4上；</li><li>各个设备的接口地址在所属网段内自行选用，终端PC1、PC2及Server的地址如图所示；</li><li>R1、R4、S2、S3的相应端口运行OSPF路由协议，各个区域的区域号由自己定义；</li><li>在R4上通过引入直连路由的方式把Server所在的网段发布进OSPF路由进程；</li><li>在S3上通过引入直连路由的方式把两台PC所在的网段发布进OSPF路由进程；</li><li>通过在R1上配置ACL，使PC2所在的网段不能访问R1右侧公网，PC1所在的网段可以访问R1右侧公网但是不能访问公网中的Server。</li></ol><p>三层交换机<code>S1</code></p><blockquote><p>Switch&gt;en<br>Switch#conf t<br>Switch(config)#vlan 2<br>Switch(config-vlan)#exit<br>Switch(config)#vlan 3<br>Switch(config-vlan)#exit<br>Switch(config)#vlan 1<br>Switch(config-vlan)#exit<br>Switch(config)#int fa 0/1<br>Switch(config-if)#sw acc vlan 1<br>Switch(config-if)#exit<br>Switch(config)#int fa 0/2<br>Switch(config-if)#sw acc vlan 2<br>Switch(config-if)#exit<br>Switch(config)#int fa 0/3<br>Switch(config-if)#sw acc vlan 3<br>Switch(config-if)#exit<br>Switch(config)#int vlan 1<br>Switch(config-if)#ip add 192.168.11.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#int vlan 2<br>Switch(config-if)#ip add 192.168.22.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#int vlan 3<br>Switch(config-if)#ip add 13.0.0.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#ip routing<br>Switch(config)#router ospf 10<br>Switch(config-router)#network 192.168.11.0 0.0.0.255 area 1<br>Switch(config-router)#network 192.168.22.0 0.0.0.255 area 1<br>Switch(config-router)#network 13.0.0.0 0.0.0.255 area 1</p></blockquote><p>三层交换机<code>S2</code></p><blockquote><p>Switch&gt;en<br>Switch#conf t<br>Switch(config)#vlan 1<br>Switch(config-vlan)#exit<br>Switch(config)#vlan 2<br>Switch(config-vlan)#exit<br>Switch(config)#int fa 0/1<br>Switch(config-if)#sw acc vlan 1<br>Switch(config-if)#exit<br>Switch(config)#int vlan 1<br>Switch(config-if)#ip add 12.0.0.2 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#int fa 0/2<br>Switch(config-if)#sw acc vlan 2<br>Switch(config-if)#exit<br>Switch(config)#int vlan 2<br>Switch(config-if)#ip add 24.0.0.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#ip routing<br>Switch(config)#router ospf 10<br>Switch(config-router)#network 12.0.0.0 0.0.0.255 area 0<br>Switch(config-router)#network 24.0.0.0 0.0.0.255 area 2</p></blockquote><p>路由器<code>R1</code></p><blockquote><p>Router&gt;en<br>Router#conf t<br>Router(config)#int fa 0/0<br>Router(config-if)#ip add 13.0.0.2 255.255.255.0<br>Router(config-if)#no shutdown<br>Router(config-if)#exit<br>Router(config)#int fa 0/1<br>Router(config-if)#ip add 12.0.0.1 255.255.255.0<br>Router(config-if)#no shutdown<br>Router(config-if)#exit<br>Router(config)#router ospf 10<br>Router(config-router)#network 13.0.0.0 0.0.0.255 area 1<br>Router(config-router)#network 12.0.0.0 0.0.0.255 area 0<br>Router(config-router)#exit<br>Router(config)#ip access-list extended 100<br>Router(config-ext-nacl)#deny ip 192.168.11.0 0.0.0.255 host 8.8.8.8<br>Router(config-ext-nacl)#permit ip 192.168.11.0 0.0.0.255 any<br>Router(config-ext-nacl)#deny ip 192.168.22.0 0.0.0.255 any<br>Router(config-ext-nacl)#permit ip any any<br>Router(config-ext-nacl)#int fa 0/1<br>Router(config-if)#ip acc<br>Router(config-if)#ip access-group 100 out</p></blockquote><p>路由器<code>R2</code></p><blockquote><p>Router&gt;en<br>Router#conf t<br>Router(config)#int fa 0/0<br>Router(config-if)#ip add 24.0.0.2 255.255.255.0<br>Router(config-if)#no shutdown<br>Router(config-if)#exit<br>Router(config)#int fa 0/1<br>Router(config-if)#ip add 8.8.8.1 255.255.255.0<br>Router(config-if)#no shutdown<br>Router(config-if)#exit<br>Router(config)#router ospf 10<br>Router(config-router)#network 24.0.0.0 0.0.0.255 area 2<br>Router(config-router)#network 8.0.0.0 0.0.0.255 area 2</p></blockquote><p>验证<br><code>PC1</code>访问<code>R1</code>右侧公网—可以访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/1.png"><br><code>PC1</code>访问服务器—不能访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/2.png"><br><code>PC2</code>访问<code>R1</code>右侧公网—不能访问<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/3.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;img src=&quot;https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ACL/banner.png&quot; width=&quot;80%&quot;&gt;
访问控制列表（Access Control List，ACL） 是路由器和交换机接口的指令列表，用来控制端口进出的数据包。ACL适用于所有的被路由协议，如IP、IPX、AppleTalk等。ACL可以过滤网络中的流量，是控制访问的一种网络技术手段。ACL是物联网中保障系统安全性的重要技术，在设备硬件层安全基础上，通过对在软件层面对设备间通信进行访问控制，使用可编程方法指定访问规则，防止非法设备破坏系统安全，非法获取系统数据。
    
    </summary>
    
    
      <category term="数据通信" scheme="https://6-7.xyz/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/"/>
    
    
      <category term="ACL" scheme="https://6-7.xyz/tags/ACL/"/>
    
  </entry>
  
  <entry>
    <title>Test</title>
    <link href="https://6-7.xyz/test.html"/>
    <id>https://6-7.xyz/test.html</id>
    <published>2019-05-28T12:40:18.000Z</published>
    <updated>2019-05-28T15:59:35.609Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/%E7%BD%91%E9%A1%B5/img/West.png" alt=""></p><a id="more"></a><iframe height="400" style="width: 100%;" scrolling="no" title="mYjxmL" src="//codepen.io/x1angfeng/embed/mYjxmL/?height=265&theme-id=0&default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true">  See the Pen <a href='https://codepen.io/x1angfeng/pen/mYjxmL/' target="_blank" rel="noopener">mYjxmL</a> by X1angfeng  (<a href='https://codepen.io/x1angfeng' target="_blank" rel="noopener">@x1angfeng</a>) on <a href='https://codepen.io' target="_blank" rel="noopener">CodePen</a>.</iframe><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=0 height=0 src="https://music.163.com/outchain/player?type=2&id=199768&auto=1&height=66"></iframe>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://b-l.oss-cn-hongkong.aliyuncs.com/%E7%BD%91%E9%A1%B5/img/West.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Linux配置与管理FTP服务</title>
    <link href="https://6-7.xyz/ftp.html"/>
    <id>https://6-7.xyz/ftp.html</id>
    <published>2019-05-21T00:40:04.000Z</published>
    <updated>2019-10-27T08:14:45.376Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>FTP用于在Internet上控制文件的双向传输。同时，它也是一个应用程序。基于不同的操作系统有不同的FTP应用程序，而所有这些应用程序都遵循同一种协议以传输文件。在FTP的使用中，用户经常遇到两个概念：“下载”和“上传”下载文件就是从远程主机复制文件到自己的电脑上💻；上传文件就是将自己电脑上💻的文件复制到远程计算机。</p></blockquote><a id="more"></a><h1 id="任务一"><a href="#任务一" class="headerlink" title="任务一"></a>任务一</h1><p><code>配置企业文件下载服务器</code><br>某公司视频网站处于经营初期，为了提高公司的知名度，争取更多的用户资源，预把自己拥有的视频资源分享给互联网用户。具体要求如下<br><strong>(1)</strong>配置FTP匿名用户的主目录为/var/ftp/anon,下载带宽限制为100KB/S.<br><strong>(2)</strong>建立一个名为abc、口令为xyz的FTP账户，下载带宽限制为500KB/S.<br><strong>(3)</strong>设置FTP服务器，同时登录到FTP服务器的最大链接数为100；每个IP最大链接数为3；用户空闲时间超过限值为5分钟。<br><strong>(4)</strong>服务器IP地址为192.168.131.129<br><span id="inline-blue">任务实施</span></p><h2 id="设置IP地址"><a href="#设置IP地址" class="headerlink" title="设置IP地址"></a>设置IP地址</h2><p>使用<code>setup</code>或者<code>vim /etc/sysconfig/network-scripts/ifcfg-eth0</code>来修改服务器的IP地址，然后使用<code>service network restart</code>重启网络服务。</p><h2 id="安装vsftpd文件"><a href="#安装vsftpd文件" class="headerlink" title="安装vsftpd文件"></a>安装vsftpd文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y vsftpd #安装vsftpd</span><br><span class="line">rpm -qa |grep vsftpd #查询安装信息</span><br></pre></td></tr></table></figure><h2 id="建立匿名用户主目录以及abc用户"><a href="#建立匿名用户主目录以及abc用户" class="headerlink" title="建立匿名用户主目录以及abc用户"></a>建立匿名用户主目录以及abc用户</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /var/ftp/anon</span><br><span class="line">useradd -s /sbin/nologin abc #建立用户不允许本地登录</span><br><span class="line">passwd abc</span><br></pre></td></tr></table></figure><h2 id="编辑配置文件"><a href="#编辑配置文件" class="headerlink" title="编辑配置文件"></a>编辑配置文件</h2><p>编辑配置文件前首先使用<code>cp -p  /etc/vsftpd/vsftpd.conf  /etc/vsftpd/vsftpd.conf.bak</code>命令备份配置文件,然后使用<code>vim /etc/vsftpd/vsftpd.conf</code>命令编辑vsftpd配置文件，主要修改的内容如下:<br><code>注意</code>有的是需要修改的,有的是需要添加的</p><p>anonymous_enable=yes<br>anon_root=/var/ftp/anon<br>anon_max_rate=100000<br>local_enable=yes<br>local_max_rate=500000<br>max_clinets=100<br>max_per_ip=3<br>connect_timeout=300</p><h2 id="配置vsftpd在系统中运行"><a href="#配置vsftpd在系统中运行" class="headerlink" title="配置vsftpd在系统中运行"></a>配置vsftpd在系统中运行</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --levels 2335 vsftpd on #开机运行</span><br><span class="line">service vsftpd restart #重启服务</span><br></pre></td></tr></table></figure><h2 id="了解配置文件"><a href="#了解配置文件" class="headerlink" title="了解配置文件"></a>了解配置文件</h2><p>anonymous_enable=yes #允许匿名用户登录<br>local_enable=yes #用户本地用户登录<br>write_enable=yes #允许本地用户具有写的权限<br>local_umask=022<br>#设置本地用户的文件生成掩码为022，默认为077；文件写入格式<br>anon_mkdir_write_enable=yes #允许匿名用户具有写的权限<br>dirmessage_enable=yes #激活上传/下载日子，当远程用户更改时提示<br>ascii_download_enable=yes #允许用户用ASCII格式来上传/下载文件<br>ftp_banner=welcome to you! #用户登录时提示欢迎词<br>userlist_enable=yes<br>#用户列表是否启用,当用户加入到/etc/vsftpd/ftpusers文件时，用户将不能访问FTP服务</p><p>经过测试abc用户和匿名用户均可访问FTP服务器资源。</p><h1 id="任务二"><a href="#任务二" class="headerlink" title="任务二"></a>任务二</h1><p><code>配置企业内部文件FTP配额</code><br><span id="inline-blue">背景</span>某工厂制造加工企业，接到一笔较大的生产订单，需要多部分联合开发配合完成，部门之间需要交换公共文件，同时也需要部门之间有各自保密的文件。<br><strong>(1)</strong>新建一个分区，10GB空间，ext3文件系统，挂载到/ftp下，作为FTP服务器数据存放的地方。<br><strong>(2)</strong>四个部门：dep1、dep2、dep3、dep4，分别对应目录<code>/ftp/dep1,/ftp/dep2,/ftp/dep3,/ftp/dep4</code>.另外设定一个公共目录/ftp/public<br><strong>(3)</strong>五个用户:admin,user1,user2,user3,user4。user1,user2,user3,user4对应的部门分别是dep1,dep2,dep3,dep4,他们只能访问属于自己部门的目录和public目录。admin管理员用户可以访问服务器上的任意一个目录。<br><strong>(4)</strong>用户访问权限控制:user1,user2,user3,user4在所能访问的目录，具有上传文件、下载文件的功能，但是不具有删除文件、更改文件权限等功能。admin管理员对所有目录有文件上传、下载、删除、权限更改等功能。<br><strong>(5)</strong>对每个部门定制一个quota，设置该账户的文件配额为1000个，磁盘配额为2GB。<br><strong>(6)</strong>禁止匿名用户访问</p><h2 id="磁盘分区与挂载"><a href="#磁盘分区与挂载" class="headerlink" title="磁盘分区与挂载"></a>磁盘分区与挂载</h2><p>增加一块硬盘，然后使用下面命令进行分区，并把分区挂载情况写入/etc/fstab</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/sdb</span><br><span class="line">mkfs.ext3 /dev/sdb1</span><br><span class="line">mkdir /ftp</span><br><span class="line">mount /dev/sdb1 /ftp -o usrquota,grpquota #挂载分区</span><br></pre></td></tr></table></figure><p>使用<code>vim /etc/fstab</code>命令设置开机自动挂载,在文件最后增加如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/dev/sdb1 /ftp ext3 defaults,usrquota,grpquota 0 0</span><br></pre></td></tr></table></figure><h2 id="建立用户与用户组并设置权限"><a href="#建立用户与用户组并设置权限" class="headerlink" title="建立用户与用户组并设置权限"></a>建立用户与用户组并设置权限</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">groupadd dep1</span><br><span class="line">groupadd dep2</span><br><span class="line">groupadd dep3</span><br><span class="line">groupadd dep4</span><br><span class="line">groupadd market</span><br><span class="line">useradd -G dep1,market user1</span><br><span class="line">useradd -G dep2,market user2</span><br><span class="line">useradd -G dep3,market user3</span><br><span class="line">useradd -G dep4,market user4</span><br><span class="line">useradd -G dep1,dep2,dep3,dep4,market admin</span><br><span class="line">passwd user1</span><br><span class="line">passwd user2</span><br><span class="line">passwd user3</span><br><span class="line">passwd user4</span><br><span class="line">passwd admin</span><br><span class="line">mkdir /ftp/dep1</span><br><span class="line">mkdir /ftp/dep2</span><br><span class="line">mkdir /ftp/dep3</span><br><span class="line">mkdir /ftp/dep4</span><br><span class="line">mkdir /ftp/public</span><br><span class="line">chown user1:dep1 /ftp/dep1</span><br><span class="line">chown user2:dep2 /ftp/dep2</span><br><span class="line">chown user3:dep3 /ftp/dep3</span><br><span class="line">chown user4:dep4 /ftp/dep4</span><br><span class="line">chown admin:market /ftp/public</span><br><span class="line">chmod 770 /ftp/dep1</span><br><span class="line">chmod 770 /ftp/dep2</span><br><span class="line">chmod 770 /ftp/dep3</span><br><span class="line">chmod 770 /ftp/dep4</span><br><span class="line">chmod 770 /ftp/public</span><br></pre></td></tr></table></figure><p>最终新建的用户、用户组、文件夹以及权限如下图所示<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ftp.png" alt=""></p><h2 id="创建quota，配置磁盘配额"><a href="#创建quota，配置磁盘配额" class="headerlink" title="创建quota，配置磁盘配额"></a>创建quota，配置磁盘配额</h2><p>使用<code>setenforce 0</code>关闭SELinux</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">quotacheck -cuvg /dev/sdb1</span><br><span class="line">quotaon -a</span><br><span class="line">edquota -g dep1</span><br></pre></td></tr></table></figure><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/edquota.png" alt=""><br>使用<code>edquota -p dep1 -g dep2 dep3 dep4</code>命令把quota属性设置套用到其余用户组。</p><h2 id="编辑配置文件-1"><a href="#编辑配置文件-1" class="headerlink" title="编辑配置文件"></a>编辑配置文件</h2><p>使用<code>vim /etc/vsftpd/vsftpd.conf</code>修改或添加如下几处内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">anonymous_enable=NO</span><br><span class="line">local_root=/ftp</span><br><span class="line">user_config_dir=/etc/vsftpd/ftp_config_dir</span><br><span class="line">chroot_list_file=/etc/vsftpd/chroot_list</span><br></pre></td></tr></table></figure><h2 id="建立用户独立文件"><a href="#建立用户独立文件" class="headerlink" title="建立用户独立文件"></a>建立用户独立文件</h2><p>使用<code>mkdir /etc/vsftpd/ftp_config_dir</code>命令建立每个用户独立文件存放的目录。使用<code>vim /etc/vsftpd/ftp_config_dir/user1</code>命令建立用户配置文件，内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmds_allowed=ABOR,ACCT,APPE,CWD,CDUP,HELP,LIST,MODE,MDTM,NOOP,NLST,PASS,PASV,PORT,PWD,QUIT,REIN,RETR,SITE,SIZE,STOR,STAT,STOU,STRU,SYST,TYPE,USER</span><br></pre></td></tr></table></figure><p>使用命令<code>cd /etc/vsftpd/ftp_config_dir</code>进入到目录下，然后使用<code>cp user1 user2</code>,<code>cp user1 user3</code>,<code>cp user1 user4</code>复制配置文件</p><h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p>使用windows作为客户端来进行验证，在资源管理器的地址栏或者，浏览器的地址栏中输入<code>ftp://192.168.131.129</code>可以看到以下内容<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/2.png" alt="">这里显示让我们输入账户以及密码才可以登陆。无法使用匿名用户访问<br>或者当使用cmd命令行输入<code>ftp 192.168.131.129</code>尝试用匿名用户登陆显示登陆失败。<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/3.png" alt=""><br>这是因为设置了禁止匿名用户访问所以才会这样，因此应该使用之前建立的用户登陆。为了区分登陆分别在/home/user1<del>4的文件夹下创建user1</del>user4文件夹。并且在/ftp/dep1<del>4目录下创建名为1</del>4的文件。<br>当各个部门用户登陆成功后分别会显示一个对应自己用户名字的文件夹<img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/1.png" alt="">)当管理员admin用户登陆成功后显示如下所示内容。<img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/admin.png" alt=""><br>下面测试使用cmd命令行的方式来进行登陆ftp服务器进行文件的上传以及下载。</p><h3 id="user1-4"><a href="#user1-4" class="headerlink" title="user1~4"></a>user1~4</h3><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/user1.png" alt=""><br>因为操作都一样所以就截了一张图<br>查看windows客户端下载的文件<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/windows.png" alt=""><br><code>1~4</code>和<code>public</code>均为从服务器上下载下来的文件，<br>查看Linux服务器被上传的文件<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/Linux.png" alt=""><br>测试客户端是否能删除文件<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/delete.png" alt="">如图显示是无法删除的，到此为止测试各个部门的上传下载以及删除权限已经测试完毕。<br>测试用户的配额是否配置成功❓<br>可以搞一个这里搞一个centos的系统镜像来测试，大小为4.16GB.最终发现是无法放入的</p><h3 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h3><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/admin1.png" alt=""><br>这里管理员用户对于四个部门的目录均具有上传、下载、删除的权限，理所当然对于公共目录public也同样具有最高的权限。</p><h1 id="任务三"><a href="#任务三" class="headerlink" title="任务三"></a>任务三</h1><p><code>配置vsftp虚拟用户访问</code></p><h2 id="安装相关文件"><a href="#安装相关文件" class="headerlink" title="安装相关文件"></a>安装相关文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install pam* -y</span><br><span class="line">yum install db4* -y</span><br></pre></td></tr></table></figure><h2 id="建立用户"><a href="#建立用户" class="headerlink" title="建立用户"></a>建立用户</h2><p>建vsftpd服务宿主用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd vsftpdadmin -s /sbin/nologin</span><br></pre></td></tr></table></figure><p>建立vsftpd服务的宿主用户用来替换root用户，并不需要登录所以指定不可用shell。</p><p>建立FTP虚拟宿主账户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd ftpuser -s /sbin/nologin</span><br></pre></td></tr></table></figure><h2 id="配置vsftpd-conf文件"><a href="#配置vsftpd-conf文件" class="headerlink" title="配置vsftpd.conf文件"></a>配置vsftpd.conf文件</h2><p>使用vim命令进行编辑，编辑前记得备份使用<code>cp /etc/vsftpd/vsftpd.conf /etc/vsftpd/vsftpd.conf.bak</code>来备份，vsftpd主配置文件，主要修改下面部分：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">anonymous_enable=NO </span><br><span class="line">chroot_list_enable=YES </span><br><span class="line">chroot_list_file=/etc/vsftpd/chroot_list</span><br></pre></td></tr></table></figure><p><code>anonymous_enable=NO</code>不允许匿名用户访问，默认为YES,<code>chroot_list_enable=YES</code>不允许FTP用户离开自己的主目录,<code>chroot_list_file=/etc/vsftpd/chroot_list</code>搭配上面一行使用的，这条是锁定用户只能登录家目录的位置，如果不开启用户登录时就会报500 OOPS的错误。</p><p id="div-border-left-blue">注意/etc/vsftpd/chroot_list本身是不存在的，需要自己手动创建。往里面输入账户一行一个</p>文件内具体代码的意义<blockquote><p>local_enable=YES #允许本地用户访问<br> write_enable=YES #允许写入<br> local_umask=022 #上传后文件的掩码<br> dirmessage_enable=YES #开启目录标语<br> xferlog_enable=YES #开启日志<br> connect_from_port_20=YES #设定连接端口<br> xferlog_std_format=YES #设定vsftpd服务日子保存路径<br> idle_session_timeout=600 #会话超时时间<br> async_abor_enable=YES #支持异步传输功能<br> ascii_upload_enable=YES #支持ASCII模式上传功能<br> ascii_download_enable=YES #支持ASCII模式的下载功能<br> ftpd_banner=Welcome to blah FTP service. #FTP登录欢迎语<br> chroot_local_user=YES #禁止本地用户登录自己的FTP主目录<br> pam_service_name=vsftpd #设定pam服务下vsftpd的验证配置文件名<br> userlist_enable=YES #拒绝登录用户名单</p></blockquote><p>userlist_deny=NO </p><p>TCP_wrappers=YES #限制主机对VSFTP服务器的访问<br> tcp_wrapper=YES<br> chroot_local_user=NO<br> guest_enable=YES #设定启用虚拟用户功能<br> guest_username=ftpuser #指定虚拟用户的宿主用户<br> virtual_use_local_privs=YES #设定虚拟用户的权限符合其宿主用户<br> user_config_dir=/etc/vsftpd/vconf #设定虚拟用户个人vsftp的配置文件存放路径</p><h2 id="建立日志文件并修改权限"><a href="#建立日志文件并修改权限" class="headerlink" title="建立日志文件并修改权限"></a>建立日志文件并修改权限</h2> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch /var/log/vsftpd.log</span><br><span class="line">chown vsftpdadmin.vsftpdadmin /var/log/vsftpd.log</span><br></pre></td></tr></table></figure><h2 id="建立虚拟用户文件"><a href="#建立虚拟用户文件" class="headerlink" title="建立虚拟用户文件"></a>建立虚拟用户文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/vsftpd/vconf</span><br><span class="line">touch /etc/vsftpd/vconf/vir_user</span><br></pre></td></tr></table></figure><h2 id="建立虚拟用户"><a href="#建立虚拟用户" class="headerlink" title="建立虚拟用户"></a>建立虚拟用户</h2><p>使用<code>vim /etc/vstfpd/vconf/vir_user</code>命令来编辑虚拟用户文件，添加如下内容。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virtualuser #账号</span><br><span class="line">123456      #密码</span><br></pre></td></tr></table></figure><p>使用<code>vim /etc/vsftpd/chroot_list</code>命令来锁定用户目录的配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virtualuser</span><br><span class="line">virtual2</span><br></pre></td></tr></table></figure><h2 id="生成数据库"><a href="#生成数据库" class="headerlink" title="生成数据库"></a>生成数据库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db_load -T -t hash -f /etc/vsftpd/vconf/vir_user /etc/vsftpd/vconf/vir_user.db</span><br></pre></td></tr></table></figure><h2 id="设置数据文件的访问权限"><a href="#设置数据文件的访问权限" class="headerlink" title="设置数据文件的访问权限"></a>设置数据文件的访问权限</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 /etc/vsftpd/vconf/vir_user</span><br><span class="line">chmod 600 /etc/vsftpd/vconf/vir_user.db</span><br></pre></td></tr></table></figure><h2 id="修改-etc-pam-d-vsftpd内容"><a href="#修改-etc-pam-d-vsftpd内容" class="headerlink" title="修改/etc/pam.d/vsftpd内容"></a>修改/etc/pam.d/vsftpd内容</h2><p>使用<code>vim /etc/pam.d/vsftpd</code>命令编辑文件，内容如下所示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#%PAM-1.0</span><br><span class="line">auth sufficient pam_userdb.so db=/etc/vsftpd/vconf/vir_user</span><br><span class="line">account sufficient pam_userdb.so db=/etc/vsftpd/vconf/vir_user</span><br></pre></td></tr></table></figure><p><strong>备注</strong>：auth是对于用户的用户名口令进行验证，account是对于用户的账户有哪些权限、哪些限制进行验证，sufficent表示充分条件，pam_userdb.so表示该条审核将调用库函数pam_userdb.so进行。db=/etc/vsftpd/vconf/vir_user指定验证库函数将到这个指定的数据库中调用数据进行验证。</p><h2 id="创建用户的配置文件"><a href="#创建用户的配置文件" class="headerlink" title="创建用户的配置文件"></a>创建用户的配置文件</h2><p>使用<code>vim /etc/vsftpd/vconf/virtualuser</code>创建用户配置文件。输入如下所示内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">local_root=/home/share</span><br><span class="line">anonymous_enable=NO</span><br><span class="line">write_enable=YES</span><br><span class="line">local_umask=0333</span><br><span class="line">anon_umask=0777</span><br><span class="line">file_open_mode=0777</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line">anon_other_write_enable=YES</span><br><span class="line">cmds_allowed=STOR,FEAT,REST,ABOR,CWD,LIST,MDTM,NLST,PASS,PASV,PORT,PWD,QUIT,RMD,RNFR,SIZE,TYPE,USER,ACCT,APPE,CDUP,HELP,MODE,NOOP,REIN,STAT,STOU,STRU,SYST,RETR</span><br><span class="line">idle_session_timeout=600</span><br><span class="line">data_connection_timeout=120</span><br><span class="line">max_clients=10</span><br><span class="line">max_per_ip=5</span><br><span class="line">local_max_rate=1048576</span><br></pre></td></tr></table></figure><h2 id="重启服务"><a href="#重启服务" class="headerlink" title="重启服务"></a>重启服务</h2><p>使用<code>service vsftpd restart</code>或者<code>/etc/init.d/vsftpd restart</code></p><h2 id="验证-1"><a href="#验证-1" class="headerlink" title="验证"></a>验证</h2><h1 id="任务四"><a href="#任务四" class="headerlink" title="任务四"></a>任务四</h1><p><code>部署专家级FTP服务器</code></p><h2 id="配置默认的vsftpd服务器"><a href="#配置默认的vsftpd服务器" class="headerlink" title="配置默认的vsftpd服务器"></a>配置默认的vsftpd服务器</h2><ol><li><p>挂载系统光盘</p><blockquote><p>mount /dev/cdrom /mnt</p></blockquote></li><li><p>安装vsftpd</p><p>在此，使用rpm的安装方式来安装，安装包放在系统光盘的Packages目录中</p><blockquote><p>rpm -ivh /mnt/Packages/vsftpd-2.2.2-11.el6_4.1.x86_64.rpm </p></blockquote></li><li><p>查看vsftpd配置文件</p><blockquote><p>grep -v “#” /etc/vsftpd/vsftpd.conf</p></blockquote><p> <img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/grep.png" alt=""></p></li><li><p>在系统中允许</p><blockquote><p>chkconfig –levels 235 vsftpd on<br>service vsftpd restart</p></blockquote></li></ol><h2 id="配置匿名用户访问和下载权限"><a href="#配置匿名用户访问和下载权限" class="headerlink" title="配置匿名用户访问和下载权限"></a>配置匿名用户访问和下载权限</h2><h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><blockquote><p>service vsftpd start</p></blockquote><p>测试前关闭selinux和防火墙</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service iptables stop</span><br><span class="line">setenforce 0</span><br></pre></td></tr></table></figure><p>在客户机中测试用文件夹方式访问<a href="ftp://192.168.131.129" target="_blank" rel="noopener">ftp://192.168.131.129</a>.</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/pub.png" alt=""></p><h3 id="测试匿名用户的上传和下载权限"><a href="#测试匿名用户的上传和下载权限" class="headerlink" title="测试匿名用户的上传和下载权限"></a>测试匿名用户的上传和下载权限</h3><p><code>注意:</code>使用匿名账户ftp登录(无密)，查看现在所有的工作目录为/，这个/并不是服务器的根目录，而是匿名用户自己的家目录，使用ls命令发现里面有一个pub文件。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/pub1.png" alt=""></p><p>匿名用户的家目录就是服务器上的/var/ftp目录。在服务器上建立一个可供下载的文件。使用<code>echo &quot;hello world&quot;&gt;/var/ftp/1.txt</code>新建一个内容为hello world的文件。回到客户机上使用<code>get 1.txt</code>命令下载文件。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/get.png" alt="">)可以在客户机上查看到一个1.txt的文件。在客户机上把下载的文件重命名一下，来测试上传。<img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/put.png" alt="">上传时被拒绝，因为匿名用户默认只能下载而不能上传。测试系统的用户的上传权限，这里可以使用<code>useradd upload</code>新建一个upload用户，使用<code>passwd upload</code>来设置用户的密码。再次用客户机进行测试，用upload登录并上传11.txt文件，文件上传成功。<img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/put1.png" alt="">使用<code>ls -l /home/upload</code>命令查看上传文件的权限为644(因为配置文件中local_umask=022)</p><h3 id="配置匿名用户拥有完全权限"><a href="#配置匿名用户拥有完全权限" class="headerlink" title="配置匿名用户拥有完全权限"></a>配置匿名用户拥有完全权限</h3><p>1.修改配置文件</p><p>可以在配置文件中加入<code>anon_mkdir_write_enable=YES</code>和<code>anon_upload_enable=YES</code>使匿名用户具有上传删除的权限。</p><p><span id="inline-purple">注意</span>当不知道如何配置要添加或者修改哪些选项时。可以使用man来找到答案<code>man vsftpd.conf</code>,查找与anon相关内容，找到anon_other_write_enable它的默认值是NO,所以设置为YES就可以允许上传、创建目录、并且删除、重命名等操作。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/a.png" alt=""></p><p>2.效果验证</p><p>使用<code>service vsftpd reload</code>命令重新加载配置，然后在客户机上再次用匿名用户进行测试。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/b.png" alt=""></p><p>发现还是无法上传和删除文件，回到服务器后查看ftp目录的权限后发现它没有写的权限，所以是无法上传和删除的。</p><p>3.修改权限</p><p>选择暴力方法使用<code>chmod 777 /var/ftp</code>将权限设为最大，然后回到客户机登录发现直接报错了。因为我们把/ftp这个目录权限设为最大，这样匿名用户就可以为所欲为了。为了避免类事情的发生为安全起见所以vsfptd设置了不允许登录。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/c.png" alt=""></p><p>4.正确配置文件夹的权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chmod 755 /var/ftp #把权限改为默认的755</span><br><span class="line">cd /var/ftp #进入ftp目录</span><br><span class="line">mkdir anon#在目录下新建目录</span><br><span class="line">chmod 777 anon  #修改目录权限</span><br><span class="line">cp 1.txt anon#复制文件到anon目录下</span><br><span class="line">cd anon#进入anon目录</span><br><span class="line">ls -l#查看1.txt的权限</span><br><span class="line">chmod 666 test.txt #修改文件权限为可写</span><br></pre></td></tr></table></figure><p>5.测试</p><p>回到客户机来测试能否删除1.txt文件和上传新的文件。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/d.png" alt=""></p><h2 id="配置登录用户禁锢在家目录"><a href="#配置登录用户禁锢在家目录" class="headerlink" title="配置登录用户禁锢在家目录"></a>配置登录用户禁锢在家目录</h2><p>vsftp用户登录系统后，当前目录一般为家目录，用户的各种操作均在此目录中实现，但是搭建的vsftpd服务器默认并不是我们想要的这样，用户是可以随意切换到系统中的其他目录中去的，这样就给系统的安全带来了很大的隐患。</p><h3 id="测试用户权限"><a href="#测试用户权限" class="headerlink" title="测试用户权限"></a>测试用户权限</h3><p>使用upload用户登录到服务器，测试是否可以切换目录。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/e.png" alt=""></p><h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><p>修改配置文件去掉<code>&quot;chroot_local_user=YES&quot;</code>前的注释符号#</p><h3 id="重启服务-1"><a href="#重启服务-1" class="headerlink" title="重启服务"></a>重启服务</h3><p>可以使用<code>service vsftpd reload</code>命令重启服务器使刚才的配置生效。</p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>在客户机使用upload用户登录，切换到根目录然后使用ls命令来查看文件发现并不能看到根目录下的内容，只能看到自己家目录下的内容。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/f.png" alt=""></p><h2 id="配置实现现在某些用户访问"><a href="#配置实现现在某些用户访问" class="headerlink" title="配置实现现在某些用户访问"></a>配置实现现在某些用户访问</h2><blockquote><p>vsftp服务和samba服务不一样，在samba服务中系统和samba用户是分开的，而在vsftp服务中，只要是系统默认用户就是vsftp用户。也就是说只要能够登录系统就可以登录vsftp服务器，这样做显然是不太合理的。</p></blockquote><p>1.查看配置vsftpd配置的相关文件</p><p>在<code>/etc/vsftpd</code>目录下有一个user_list文件，使用cat命令来查看文件中的内容，发现都是拒绝登录vsftp服务器的用户。所以谁不可以登录就把账号写进这个文件中。</p><p>2.添加拒绝账户到文件中</p><p>使用<code>vim /etc/vsftpd/user_list</code>命令编辑文件在最后一行加入upload账户用以拒绝访问upload登录ftp服务器。然后重启服务</p><p>3.效果验证</p><p>回到客户机用upload登录，会显示失败。<img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/g.png" alt=""></p><p><span id="inlie-blue">备注</span>这里登录失败的原因是应为把upload写进了user_list这个文件中，这个拒绝用户登录之所以生效是因为<code>/etc/vsftpd/vsftpd.conf</code>配置文件中默认有“user_list_enalbe=YES”这行设置，如果把此配置改成“user_list_enable=YES”那么就只有写进user_list文件中的用户才可以登录。</p><h2 id="配置虚拟用户FTP访问"><a href="#配置虚拟用户FTP访问" class="headerlink" title="配置虚拟用户FTP访问"></a>配置虚拟用户FTP访问</h2><p>在vsftp服务器中，系统用户就是vsftp用户,那么vsftp账户也能够登录系统，为了系统安全考虑，运维人员往往需要只建立vsftp用户，而不希望登录系统，这时就需要用到vsftp服务器的虚拟账户功能。</p><h3 id="新建虚拟用户名文件"><a href="#新建虚拟用户名文件" class="headerlink" title="新建虚拟用户名文件"></a>新建虚拟用户名文件</h3><p>使用<code>vim /etc/vsftpd/vuser</code>命令创建用于存放虚拟用户的文件。文件中奇数行为用户名，偶数行为密码。先在创建两个名分别为Tom和Jack,密码为qwe123的虚拟用户。</p><h3 id="将文件转换成数据库文件"><a href="#将文件转换成数据库文件" class="headerlink" title="将文件转换成数据库文件"></a>将文件转换成数据库文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/vsftpd</span><br><span class="line">db_load -T -thash -f vuser vuser.db</span><br></pre></td></tr></table></figure><p>参数-T指定转换后的文件类型为hash，参数-f指定转换后的文件名为vuser.db。可以使用<code>file vuser.db</code>来查看文件的类型。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/h.png" alt=""></p><h3 id="修改用户文件权限"><a href="#修改用户文件权限" class="headerlink" title="修改用户文件权限"></a>修改用户文件权限</h3><p>为了安全，不能让其他用户拥有vuser和vuser.db文件的任何权限。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 /etc/vsftpd/vuser</span><br><span class="line">chmod 600 /etc/vsftpd/vuser.db</span><br></pre></td></tr></table></figure><h3 id="创建虚拟用户的映射账户"><a href="#创建虚拟用户的映射账户" class="headerlink" title="创建虚拟用户的映射账户"></a>创建虚拟用户的映射账户</h3><p>虚拟用户创建之后，要给虚拟用户映射到一个系统账号，使用<code>useradd -d /opt/vuser -s /sbin/nologin vuser</code>命令新建一个虚拟用户的映射账号vuser,指定宿主目录为<code>/opt/vuser</code>,并指定不能登录系统。</p><h3 id="配置用户认证信息"><a href="#配置用户认证信息" class="headerlink" title="配置用户认证信息"></a>配置用户认证信息</h3><p>使用<code>vim /etc/pam.d/vsftpd.vu</code>命令为虚拟用户创建pam认证模块，名字为vsftpd.vu。在认证文件中加入如下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">auth required pam_userdb.so db=/etc/vsftpd/vuser</span><br><span class="line">account required pam_userdb.so db=/etc/vsftpd/vuser</span><br></pre></td></tr></table></figure><p>这里的vuser其实是vuser.db,这里省略了.db，否则会报错。</p><h3 id="开启虚拟用户访问"><a href="#开启虚拟用户访问" class="headerlink" title="开启虚拟用户访问"></a>开启虚拟用户访问</h3><p>使用<code>vim /etc/vsftpd/vsftpd.conf</code>编辑配置文件，在文件的最后添加如下内容，注释掉<code>pam_service_name=vsftpd</code>。如下图所示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">guest_enable=YES</span><br><span class="line">guest_username=vuser</span><br><span class="line">pam_service_name=vsftpd.vu</span><br></pre></td></tr></table></figure><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/i.png" alt=""></p><h3 id="效果验证"><a href="#效果验证" class="headerlink" title="效果验证"></a>效果验证</h3><p>使用<code>service vsftpd restart</code>命令重启服务，用客户机进行测试。分别使用Tom和Jack登录并上传文件</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/j.png" alt=""></p><p>使用<code>ls -l /opt/vuser</code>命令查看上传的文件的属主,发现属主均为vuser。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/k.png" alt=""></p><h2 id="配置虚拟用户拥有不同的文件权限"><a href="#配置虚拟用户拥有不同的文件权限" class="headerlink" title="配置虚拟用户拥有不同的文件权限"></a>配置虚拟用户拥有不同的文件权限</h2><h3 id="开启单独配置文件功能"><a href="#开启单独配置文件功能" class="headerlink" title="开启单独配置文件功能"></a>开启单独配置文件功能</h3><p>打开vsftpd.conf配置文件，加入以下一行内容，告诉配置文件在vu_dir目录下找用户的单独权限配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user_config_dir=/etc/vsftpd/vu_dir</span><br></pre></td></tr></table></figure><h3 id="建立用户权限文件"><a href="#建立用户权限文件" class="headerlink" title="建立用户权限文件"></a>建立用户权限文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/vsftpd/vu_dir #新建vu_dir目录</span><br><span class="line">cd /etc/vsftpd/vu_dir #进入vu_dir目录</span><br><span class="line">touch Jack</span><br></pre></td></tr></table></figure><p>使用man命令发现anon_umask(匿名上传)的默认权限为600，如国要改变Jack的上传权限为644的话，就把这个值设置为022即可。使用<code>vim Jack</code>命令编辑文件在文件中写入<code>anon_umask=022</code></p><h3 id="效果验证-1"><a href="#效果验证-1" class="headerlink" title="效果验证"></a>效果验证</h3><p>重启服务后，用客户机登录Jack上传一个新的文件。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/FTP/l.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;FTP用于在Internet上控制文件的双向传输。同时，它也是一个应用程序。基于不同的操作系统有不同的FTP应用程序，而所有这些应用程序都遵循同一种协议以传输文件。在FTP的使用中，用户经常遇到两个概念：“下载”和“上传”下载文件就是从远程主机复制文件到自己的电脑上💻；上传文件就是将自己电脑上💻的文件复制到远程计算机。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://6-7.xyz/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://6-7.xyz/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Linux搭建流媒体服务器</title>
    <link href="https://6-7.xyz/media.html"/>
    <id>https://6-7.xyz/media.html</id>
    <published>2019-05-17T05:45:00.000Z</published>
    <updated>2019-10-27T08:14:47.334Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>流媒体指以流方式在网络中传送音频、视频和多媒体文件的媒体形式。相对于下载后观看的网络播放形式而言，流媒体的典型特征是把连续的音频和视频信息压缩后放到网络服务器上，用户边下载边观看，而不必等待整个文件下载完毕。由于流媒体技术的优越性，该技术广泛应用于视频点播、视频会议、远程教育、远程医疗和在线直播系统中。作为新一代互联网应用的标志，流媒体技术在近几年得到了飞速的发展。</p></blockquote><a id="more"></a><h1 id="搭建RTSP流媒体服务器（Darwin-Streaming-Server）"><a href="#搭建RTSP流媒体服务器（Darwin-Streaming-Server）" class="headerlink" title="搭建RTSP流媒体服务器（Darwin Streaming Server）"></a>搭建RTSP流媒体服务器（Darwin Streaming Server）</h1><p><code>注意:</code>上来首先关闭linux系统的防火墙以及selinux然后再进行下面的操作。使用命令<code>service iptables stop</code>和<code>setenforce 0</code>来关闭防火墙以及selinux。这里之所以选择关闭是为后面的测试做准备的。⚠仅限学习测试过程中使用，实际生产过程中是🈲不能这样的。</p><h2 id="安装依赖组件"><a href="#安装依赖组件" class="headerlink" title="安装依赖组件"></a>安装依赖组件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ perl ld-linux.so.2 libstdc++.so.6</span><br></pre></td></tr></table></figure><h2 id="下载并安装Darwin-Streaming-Server"><a href="#下载并安装Darwin-Streaming-Server" class="headerlink" title="下载并安装Darwin Streaming Server"></a>下载并安装Darwin Streaming Server</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://dss.macosforge.org/downloads/DarwinStreamingSrvr5.5.5-Linux.tar.gz</span><br><span class="line">tar -zxvf DarwinStreamingSrvr5.5.5-Linux.tar.gz</span><br><span class="line">cd DarwinStreamingSrvrlinux-Linux</span><br><span class="line">./Install</span><br></pre></td></tr></table></figure><p>上述过程均在root用户权限下进行操作。安装的过程中会让你建立一个用户并且设置密码。</p><h2 id="访问访问Darwin-Streaming-Server-WEB界面"><a href="#访问访问Darwin-Streaming-Server-WEB界面" class="headerlink" title="访问访问Darwin Streaming Server WEB界面"></a>访问访问Darwin Streaming Server WEB界面</h2><p>打开浏览器，在网址栏输入<code>http://192.168.131.129:1220/</code>我这里的服务器IP地址为192.168.131.129，你需要替换成为你自己的服务器IP地址。<br><span id="inline-blue">初始设置</span><br><em>1.</em>Setup Assistant MP3 Broadcast Password：这里重复输入你的密码，然后点Next下一步；<br><em>2、</em>Setup Assistant Secure Administration：不用勾选，直接点Next下一步；<br><em>3、</em>Setup Assistant Media Folder:默认为/usr/local/movies，不建议修改，直接点Next下一步；<br><em>4、</em>Setup Assistant Streaming on Port 80：不建议改端口，点Finish完成设置向导。<br>！<a href="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/wy.png" target="_blank" rel="noopener"></a><br>页面如图所示，可以对其进行一系列的操作和修改。<br>启动服务<code>sudo /usr/local/sbin/DarwinStreamingServer</code>开启WEB服务器<code>sudo /usr/local/sbin/streamingadminserver.pl</code>设置开机启动的话可以编辑<code>/etc/rc.local</code>文件在exit 0之前加入如下内容。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/sbin/DarwinStreamingServer</span><br><span class="line">/usr/local/sbin/streamingadminserver.pl</span><br></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>这里使用的是VLC播放器▶，若没有安装的话可以通过下面命令来安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/yum.repos.d/ </span><br><span class="line">wget http://pkgrepo.linuxtech.net/el6/release/linuxtech.repo </span><br><span class="line">yum  -y install vlc</span><br></pre></td></tr></table></figure><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/vnc.png" alt=""><br>打开vlc播放器点击上角的“媒体”然后点击打开网络串流然后输入网络地址URL,要想播放/usr/local/movies下的视频。那么输入的地址就是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rtsp://192.168.131.128/sample_h264_1mbit.mp4</span><br></pre></td></tr></table></figure><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/test.png" alt=""></p><p>这里呢显示了绿屏，视频倒是可以播放。但是却看不到动画那么怎么解决呢❓</p><p>操作流程为：工具-&gt;首选项-&gt;视频-&gt;显示-&gt;输出-&gt;OpenGL GLX视频输出。如下所示：</p><div id="dplayer0" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer0"),"theme":"#FADFA3","loop":true,"video":{"url":"https://b-l.oss-cn-hongkong.aliyuncs.com/viedo/vlc.mp4","pic":"https://b-l.oss-cn-hongkong.aliyuncs.com/picture/513116.png"}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><p>如果想要播放其他的文件夹下的视频的话，在网页端修改Media Directory<br><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/shezhi.png" alt=""></p><p>下面我们来测试一下，换了文件夹视频能否正常播放呢❓经过测试依旧以可播放。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/bofang.png" alt=""></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/q.png" alt=""></p><p>测试呢是直接把movies目录下的视频移动到media文件夹下，成功测试成功。但是使用media目录下原有的1.MP4媒体文件却报了如下错误。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/error.png" alt=""></p><p>结果呢出了上图所示的信息，换了目录后播放失败了😂。按道理是可以播放的呀但是为什么会这样呢❓</p><p>我的第一反应就是莫非是因为权限的缘故导致无法播放，第二反应则是文件必须得串流才能播放。</p><h3 id="想法一"><a href="#想法一" class="headerlink" title="想法一"></a>想法一</h3><p>所以首先就分别查看两个文件夹下文件的权限<img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/qx.png">这里发现1.MP4文件的属主和属组均为root，而其他的文件的属主和属组分别是qtss和root。所以我就选择修改1.MP4的权限来试着尝试能否正常播放。结果还是同样的问题😒，所以选择使用修改权限的方法是行不通的。</p><h3 id="想法二"><a href="#想法二" class="headerlink" title="想法二"></a>想法二</h3><p>既然第一条路走不通那就选择走另外一条路好了🤣实在不行的话，用谷歌上肯定可以找到答案的。那么怎么串流呢主要步骤如下</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/liu.png"><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/liu1.png"><p>点击下一个选择RSTP然后点击添加端口选择默认的8554，改成自己的也可。路径改为1.mp4.同时不选择本地显示以及激活转码。然后点击下一个这个页面不需要做操作，直接选择串流就🆗。</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/liu2.png"><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/liu3.png"><p>到此就貌似好像大概或许应该可能就大功告成了，屁话少说测试一下就知道了。</p><p>测试机为装有vlc播放器的windows 7，视频较短的话可以设置循环播放。因为很可能会有这种情况的发生，等你输完URL地址它就播放结束了，还是会提示之前的那种❌错误情况。测试和之前方法一样在这我输入的地址为<code>rstp://192.168.131.129:8554/1.mp4</code></p><div id="dplayer1" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer1"),"theme":"#FADFA3","loop":true,"video":{"url":"https://b-l.oss-cn-hongkong.aliyuncs.com/viedo/test.mp4","pic":"https://b-l.oss-cn-hongkong.aliyuncs.com/picture/513116.png"}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><center><p id="div-border-left-red">(⓿_⓿)到此终于大功告成</p></center><h1 id="nginx-ffmpeg搭建流媒体服务器"><a href="#nginx-ffmpeg搭建流媒体服务器" class="headerlink" title="nginx+ffmpeg搭建流媒体服务器"></a>nginx+ffmpeg搭建流媒体服务器</h1><p>前面介绍了如何使用Darwin Streaming Server搭建流媒体服务器,下面来介绍使用nginx+ffmpeg搭建流媒体服务器。</p><h2 id="安装yasm"><a href="#安装yasm" class="headerlink" title="安装yasm"></a>安装yasm</h2><p id="div-border-left-yellow">Yasm是一个完全重写的NASM汇编。目前，它支持x86和AMD64指令集。     接受NASM和GNU汇编器（gas）语法，产出二进制， ELF32 ， ELF64 ， COFF ， Mach - O的（ 32和64 ） ， RDOFF2 ，的Win32和Win64对象的格式，并生成STABS 调试信息的来源，DWARF 2 ，CodeView 8格式。</p><p>下载yasm</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz</span><br></pre></td></tr></table></figure><p>解压和安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf yasm-1.3.0.tar.gz</span><br><span class="line">cd yasm-1.3.0</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h2 id="安装lame"><a href="#安装lame" class="headerlink" title="安装lame"></a>安装lame</h2><p id="div-border-top-green" >用于mp3编码。由于专利版权问题，ffmpeg默认不带mp3格式编码器，但是有mp3格式解码器。</p><p>下载lame</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://sourceforge.net/projects/lame/files/lame/3.99/lame-3.99.5.tar.gz/download</span><br><span class="line">#下载下来的文件名是down重命名为实际的名字</span><br></pre></td></tr></table></figure><p>解压和安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mv download lame-3.99.5.tar.gz</span><br><span class="line">tar -zxvf lame-3.99.5.tar.gz</span><br><span class="line">cd lame-3.99.5</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">#编译安装后并没有加入系统库中，添加如下软连接加入系统库</span><br><span class="line">ln -s /usr/local/lib/libmp3lame.so.0.0.0 /usr/lib64/libmp3lame.so.0</span><br></pre></td></tr></table></figure><h2 id="安装ffmpeg"><a href="#安装ffmpeg" class="headerlink" title="安装ffmpeg"></a>安装ffmpeg</h2><p>下载ffmpeg</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.ffmpeg.org/releases/ffmpeg-3.1.tar.gz</span><br></pre></td></tr></table></figure><p>解压和安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf ffmpeg-3.1.tar.gz</span><br><span class="line">cd ffmpeg-3.1</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>安装完成后可以通过<code>ffmpeg -version</code>查看安装的版本，可以通过<code>ffmpeg -codecs |grep 媒体格式</code>来查看对媒体格式的支持情况。</p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ffmpeg.png"><h2 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h2><p>安装依赖</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc pcre-devel openssl openssl-devel</span><br></pre></td></tr></table></figure><p>下载nginx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget  http://nginx.org/download/nginx-1.8.1.tar.gz</span><br></pre></td></tr></table></figure><p>解压和安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf nginx-1.8.1.tar.gz</span><br><span class="line">cd nginx-1.8.1</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>启动nginx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure><p>可以在浏览器中输入<code>http://localhost</code>来进行测试，看到<code>welcome to nginx</code>则说明安装成功。默认端口为80端口可以通过<code>vim /usr/local/nginx/conf/nginx.conf</code>命令来对nginx的配置文件进行修改。修改完成后重启即可生效</p><h3 id="安装rtmp模块"><a href="#安装rtmp模块" class="headerlink" title="安装rtmp模块"></a>安装<strong>rtmp模块</strong></h3><p>官方github地址：<code>https://github.com/arut/nginx-rtmp-module</code>,因此需要安装git。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install git</span><br><span class="line">git clone https://github.com/arut/nginx-rtmp-module.git</span><br></pre></td></tr></table></figure><p> 重新安装nginx并拓展nginx-rtmp-module模块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/nginx  --add-module=../nginx-rtmp-module  --with-http_ssl_module</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h2 id="启动-nginx-的命令："><a href="#启动-nginx-的命令：" class="headerlink" title="启动 nginx 的命令："></a>启动 nginx 的命令：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo /usr/local/nginx/sbin/nginx -s stop</span><br><span class="line">$ sudo /usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure><h2 id="配置推流地址以及播放页面"><a href="#配置推流地址以及播放页面" class="headerlink" title="配置推流地址以及播放页面"></a><strong>配置推流地址以及播放页面</strong></h2><p>使用<code>vi /usr/local/nginx/conf/nginx.conf</code>命令来编辑nginx配置文件，主要修改的地方如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">##切换自动推送(多 worker 直播流)模式。默认为 off</span><br><span class="line">rtmp_auto_push on;</span><br><span class="line">##当 worker 被干掉时设置自动推送连接超时时间。默认为 100 毫秒</span><br><span class="line">rtmp_auto_push_reconnect 1s;</span><br><span class="line">rtmp &#123;</span><br><span class="line">        server&#123;</span><br><span class="line">                listen 1935;</span><br><span class="line">                #直播流配置</span><br><span class="line">                application live &#123;</span><br><span class="line">                live on;</span><br><span class="line">                record off;</span><br><span class="line">                &#125;</span><br><span class="line">                application hls &#123;</span><br><span class="line">                live on;</span><br><span class="line">                hls on;</span><br><span class="line">                hls_path /tmp/hls;</span><br><span class="line">                hls_fragment 1s;</span><br><span class="line">                &#125;</span><br><span class="line">                # 视频点播</span><br><span class="line">                application vod &#123;</span><br><span class="line">                play /tmp/viedo;</span><br><span class="line">                &#125;</span><br><span class="line">                application vod_http&#123;</span><br><span class="line">                play http://youserverIp/vod;</span><br><span class="line">                &#125;</span><br><span class="line">        #rtmp日志设置</span><br><span class="line">        access_log logs/rtmp_access.log ;</span><br><span class="line">        &#125;</span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line">    #                  &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">    #                  &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  6-07.club;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /wang/html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">         #rtmp状态页面</span><br><span class="line">         location /stat &#123;</span><br><span class="line">         rtmp_stat all;</span><br><span class="line">         rtmp_stat_stylesheet stat.xsl;</span><br><span class="line">         &#125;</span><br><span class="line">         location /stat.xsl &#123;</span><br><span class="line">         root /opt/software/nginx-rtmp-module/;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         location /hls &#123;</span><br><span class="line">         types &#123;</span><br><span class="line">         application/vnd.apple.mpegurl m3u8;</span><br><span class="line">  video/mp2t ts;</span><br><span class="line">         &#125;</span><br><span class="line">         root /tmp;</span><br><span class="line">         add_header Cache-Control no-cache;</span><br><span class="line">&#125;</span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">include vhosts/*.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面来解释一下里面各行代码的含义。对于视频直播服务，如果需要支持多路流输入的话，很简单，在 nginx 配置文件里多配几个 Application 就只可以了，像下面这样：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">application live &#123;</span><br><span class="line">live on;</span><br><span class="line">record off;</span><br><span class="line">&#125;</span><br><span class="line">application live2 &#123;</span><br><span class="line">live on;</span><br><span class="line">record off;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就可以通过下面的地址来推送直播流，其它观众端也可以通过下面的地址来访问直播流：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rtmp://youserverIp/live/test</span><br><span class="line">rtmp://youserverIp/live2/test</span><br></pre></td></tr></table></figure><p>后面紧跟的 test 关键字，可以随便更换，只要你的推送流和访问流的地址一样就可以了。</p><p><a href="https://github.com/arut/nginx-rtmp-module/wiki/Directives#video-on-demand" target="_blank" rel="noopener">rtmp 模块也可以直接支持 VOD 这种视频点播服务</a> ，只需要在配置文件里添加如下内容即可：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># video on demand</span><br><span class="line">application vod &#123;</span><br><span class="line">    play /tmp/viedo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">application vod_http &#123;</span><br><span class="line">    play http://youserverIp/vod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后把一个 mp4 或是 flv 文件移动到 /tmp/viedo目录下，对于  /tmp/viedo/hello/test.mp4 这个视频文件，就可以通过下面的网址来访问了：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmtp://youserverip/vod//hello/test.mp4</span><br></pre></td></tr></table></figure><p>hls直播流配置</p><p>如果需要使用 HLS 来视频直播，可以直接像配置文件那样，写上下面这一段：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">application hls &#123;</span><br><span class="line">        live on;</span><br><span class="line">        hls on;</span><br><span class="line">        hls_path /tmp/hls;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在下面的http中加入如下信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#rtmp状态页面</span><br><span class="line">         location /stat &#123;</span><br><span class="line">         rtmp_stat all;</span><br><span class="line">         rtmp_stat_stylesheet stat.xsl;</span><br><span class="line">         &#125;</span><br><span class="line">         location /stat.xsl &#123;</span><br><span class="line">         root /opt/software/nginx-rtmp-module/;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         location /hls &#123;</span><br><span class="line">         types &#123;</span><br><span class="line">         application/vnd.apple.mpegurl m3u8;</span><br><span class="line">  video/mp2t ts;</span><br><span class="line">         &#125;</span><br><span class="line">         root /tmp;</span><br><span class="line">         add_header Cache-Control no-cache;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置好后若推流地址为<code>rtmp://193.112.247.63/hls/hello</code>则播放地址如下</p><ol><li><p>使用rtmp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rtmp://193.112.247.63/hls/hello</span><br></pre></td></tr></table></figure></li><li><p>使用hls</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://193.112.247.63/hls/hello.m3u8</span><br></pre></td></tr></table></figure><p>此链接是在ios以及mac系统的浏览器内可以直接正常播放直播流的。</p></li></ol><h2 id="使用ffmpeg推流直播"><a href="#使用ffmpeg推流直播" class="headerlink" title="使用ffmpeg推流直播"></a>使用ffmpeg推流直播</h2><ol><li><p>使用ffmpeg推流到nginx<br>使用rtmp协议推一个本地的mp4到上面配置的myapp上</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -re -i /tmp/live/test.mp4 -vcodec copy -acodec copy -f flv &quot;rtmp://127.0.0.1:1935/live/test1&quot;</span><br></pre></td></tr></table></figure><p>流播放地址为：<code>rtmp://193.112.247.63:1935/live/test1</code>或者<code>rtmp://6-07.club:1935/live/test1</code></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/test1.png" alt=""></p><p>使用hls协议推一个本地的mp4到hls上（apple公司开发的，可在iPad、safari的中进行播放）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -re -i /tmp/live/test.mp4 -vcodec copy -acodec copy -f flv &quot;rtmp://127.0.0.1:1935/hls/test2&quot;</span><br></pre></td></tr></table></figure><p>流播放地址为:<code>http://193.112.247.63/hls/test2.m3u8</code>或者<code>http://6-07.club/hls/test2.m3u8</code></p><p>上面也讲过hls协议推流同样可以使用rmtp协议来进行拉流。地址为<code>rtmp://193.112.247.63/hls/test2</code>或者<code>rtmp://6-07.club/hls/test2</code></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/test2.png" alt=""></p><h2 id="使用OBS推流"><a href="#使用OBS推流" class="headerlink" title="使用OBS推流"></a>使用OBS推流</h2><p><a href="https://obsproject.com/" target="_blank" rel="noopener">🚀</a>这个是传送链接，主要有windows、Linux、macos三种版本，请根据自己的需求下载。</p><p>打开后点击左上角的文件–&gt;设置–&gt;串流。服务选择自定义，服务器选择输入自己的流媒体服务器地址。串流密钥可以随遍填。但是自己要记住，要不然等下播放时会出错。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/sbo.png" alt=""></p><p>播放地址为<code>rtmp://193.112.247.63/hls/obs</code></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/obs.png" alt=""></p><p>这里采用的是推送本地的媒体源，当然你自己也可以选择其他的。</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/obs1.png" alt=""></p><p>使用obs比ffmpeg有诸多的好处，懂得自然都懂这里就不在详细的介绍OBS的强大之处了。</p><h2 id="视频点播服务"><a href="#视频点播服务" class="headerlink" title="视频点播服务"></a>视频点播服务</h2><p>具体怎么实现上面已经介绍过，视频点播服务可以使观众根据自己的爱好来观看视频。点播地址<code>rtmp://193.112.247.63/vod//hello/test.mp4</code></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/dian.png" alt=""></p><p>这里可以选择快进进行视频的观看，并且可以显示视频的长短。</p><center>未完待续</center><h2 id="网页点播，网页直播。"><a href="#网页点播，网页直播。" class="headerlink" title="网页点播，网页直播。"></a>网页点播，网页直播。</h2></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;流媒体指以流方式在网络中传送音频、视频和多媒体文件的媒体形式。相对于下载后观看的网络播放形式而言，流媒体的典型特征是把连续的音频和视频信息压缩后放到网络服务器上，用户边下载边观看，而不必等待整个文件下载完毕。由于流媒体技术的优越性，该技术广泛应用于视频点播、视频会议、远程教育、远程医疗和在线直播系统中。作为新一代互联网应用的标志，流媒体技术在近几年得到了飞速的发展。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://6-7.xyz/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://6-7.xyz/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>路由器OSPF动态路由配置</title>
    <link href="https://6-7.xyz/ospf.html"/>
    <id>https://6-7.xyz/ospf.html</id>
    <published>2019-05-16T09:09:44.000Z</published>
    <updated>2019-07-24T02:32:06.405Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>假设校园网通过一台三层交换机连到校园网出口路由器上，路由器再和校园外的另一台路由器连接。现要做适当配置，实现校园网内部主机与校园网外部主机之间的相互通信。为了简化网管的管理维护工作，学校决定采用OSPF协议实现互通。</p></blockquote><a id="more"></a><h1 id="技术原理"><a href="#技术原理" class="headerlink" title="技术原理"></a><strong>技术原理</strong></h1><p>🎈OSPF开放式最短路径优先协议，是目前网路中应用最广泛的路由协议之一。属于内部网管路由协议，能够适应各种规模的网络环境，是典型的链路状态协议。OSPF路由协议通过向全网扩散本设备的链路状态信息，使网络中每台设备最终同步一个具有全网链路状态的数据库，然后路由器采用SPF算法，以自己为根，计算到达其他网络的最短路径，最终形成全网路由信息。</p><h1 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a><strong>实验步骤</strong></h1><p>🎈新建packet tracer拓扑图</p><p>（1）在本实验中的三层交换机上划分VLAN10和VLAN20，其中VLAN10用于连接校园网主机，VLAN20用于连接R1。</p><p>（2）路由器之间通过V35电缆通过串口连接，DCE端连接在R1上，配置其时钟频率64000。</p><p>（3）主机和交换机通过直连线，主机与路由器通过交叉线连接。</p><p>（4）在S3560上配置OSPF路由协议。</p><p>（5）在路由器R1、R2上配置OSPF路由协议。</p><p>（6）将PC1、PC2主机默认网关设置为与直连网路设备接口IP地址。</p><p>（7）验证PC1、PC2主机之间可以互相通信；</p><h1 id="实验设备"><a href="#实验设备" class="headerlink" title="实验设备"></a>实验设备</h1><p>PC 2台；Switch_3560 1台；Router-PT 2台；直连线；交叉线；DCE串口线</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/ospf.png" alt=""></p><p><code>PC1</code> </p><p>​       IP:                 192.168.1.2</p><p>​       Submask:        255.255.255.0</p><p>​       Gateway:        192.168.1.1</p><p><code>PC2</code></p><p>​       IP:                 192.168.2.2</p><p>​       Submask:        255.255.255.0</p><p>​       Gateway:        192.168.2.1 </p><p>🌈配置<code>S3560</code></p><p>Switch&gt;en</p><p>Switch#conf t</p><p>Switch(config)#vlan 10</p><p>Switch(config-vlan)#exit</p><p>Switch(config)#vlan 20</p><p>Switch(config-vlan)#exit</p><p>Switch(config)#int fa 0/1</p><p>Switch(config-if)#sw acc vlan 10</p><p>Switch(config-if)#exit</p><p>Switch(config)#int fa 0/2</p><p>Switch(config-if)#sw acc vlan 20</p><p>Switch(config-if)#exit</p><p>Switch(config)#int vlan 10</p><p>Switch(config-if)#ip add 192.168.1.1 255.255.255.0</p><p>Switch(config-if)#no shutdown</p><p>Switch(config-if)#exit</p><p>Switch(config)#int fa 0/2</p><p>Switch(config-if)#ip add 192.168.3.1 255.255.255.0</p><p>Switch(config-if)#no shutdown </p><p>Switch(config-if)#exit</p><p>Switch(config)#router ospf 1</p><p>Switch(config-router)#network 192.168.1.0 0.0.0.255 area 0</p><p>Switch(config-router)#network 192.168.3.0 0.0.0.255 area 0 </p><p>Switch(config-router)#end</p><p>🌈<code>R1</code>的配置</p><p>Router&gt;en</p><p>Router#conf t</p><p>Router(config)#int fa 0/0</p><p>Router(config-if)#ip add 192.168.3.2 255.255.255.0</p><p>Router(config-if)#no shutdown</p><p>Router(config-if)#exit</p><p>Router(config)#int serial 2/0</p><p>Router(config-if)#ip add 192.168.4.1 255.255.255.0</p><p>Router(config-if)#no shutdown</p><p>Router(config-if)#clock  rate 64000</p><p>Router(config-if)#exit</p><p>Router(config)#router ospf 1</p><p>Router(config-router)#network 192.168.3.0 0.0.0.255 area 0</p><p>Router(config-router)#network 192.168.4.0 0.0.0.255 area 0</p><p>Router(config-router)#end</p><p>🌈<code>R2</code>的配置</p><p>Router&gt;en</p><p>Router#conf t</p><p>Router(config)#int fa 0/0</p><p>Router(config-if)#ip add 192.168.2.2 255.255.255.0</p><p>Router(config-if)#no shutdown</p><p>Router(config-if)#exit</p><p>Router(config)#int serial 2/0</p><p>Router(config-if)#ip add 192.168.4.2 255.255.255.0</p><p>Router(config-if)#no shutdown</p><p>Router(config-if)#exit</p><p>Router(config)#router ospf 1</p><p>Router(config-router)#network 192.168.4.0 0.0.0.255 area 0</p><p>Router(config-router)#network 192.168.2.0 0.0.0.255 area 0</p><p>Router(config-router)#end</p><h1 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h1><p>PC1、PC2主机之间可以互相通信</p><p><code>PC1</code> ping <code>PC2</code></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/1.png" alt=""></p><p><code>PC2</code> ping <code>PC1</code></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/2.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;假设校园网通过一台三层交换机连到校园网出口路由器上，路由器再和校园外的另一台路由器连接。现要做适当配置，实现校园网内部主机与校园网外部主机之间的相互通信。为了简化网管的管理维护工作，学校决定采用OSPF协议实现互通。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="数据通信" scheme="https://6-7.xyz/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/"/>
    
    
      <category term="OSPF" scheme="https://6-7.xyz/tags/OSPF/"/>
    
  </entry>
  
  <entry>
    <title>解决VMware虚拟机桥接无法上网问题</title>
    <link href="https://6-7.xyz/%F0%9F%90%94.html"/>
    <id>https://6-7.xyz/🐔.html</id>
    <published>2019-05-16T06:29:28.000Z</published>
    <updated>2019-06-23T02:52:41.529Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>在使用VMware虚拟机时，有些情况下我们使用桥接的方式来进行上网。但是大多数情况下选择桥接的方式在虚拟机中是无法正常上网的。自己之前也曾遇到过这样的问题。。。<a id="more"></a></p><ol><li><p><strong><em>查看本地网络是否安装VMware Bridge Protocol</em></strong></p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/wlan.png" alt=""></p><p>就像上图所示一样，我这里查看的是WLAN的属性。如果没有安装的话，选择安装即可。</p></li><li><p>查看本地IP地址</p><p><code>win +r</code>输入<code>cmd</code>打开命令行，输入<code>ipconfig /all</code>查看物理机局域网内的信息</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/china.png" alt=""></p><p>可以看到 </p><p>​    网卡: Intel(R) Dual Band Wireless-AC 3165</p><p>​    IPv4 地址 . . . . . . . . . . . . : 10.10.2.39(首选)<br>   子网掩码  . . . . . . . . . . . . : 255.255.252.0</p><p>​    默认网关. . . . . . . . . . . . . : 10.10.0.1<br>   DNS 服务器  . . . . . . . . . . . : 202.96.209.5</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/bkl.jpg" alt=""></p></li><li><p>使用虚拟机网络编辑器</p><p><code>需要使用管理员权限才可以进行操作</code>，还原默认设置然后设置桥接为如下图所示</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/xn.png" alt=""></p><p>修改为如上图所示桥接到物理机的无线网卡上。然后设置虚拟机的设置修改为如下所示</p><p><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/photos/bridge.png" alt=""></p></li><li><p>虚拟机开机测试</p><p>开机后打开命令行查看一下是否成功，查看IP地址发现虚拟机和物理机在同一个网段下。</p><p>虚拟机ping物理机,物理机ping虚拟机发现均可以ping通。同时也可以打开网页正常上网👾</p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在使用VMware虚拟机时，有些情况下我们使用桥接的方式来进行上网。但是大多数情况下选择桥接的方式在虚拟机中是无法正常上网的。自己之前也曾遇到过这样的问题。。。
    
    </summary>
    
    
    
      <category term="VMware" scheme="https://6-7.xyz/tags/VMware/"/>
    
  </entry>
  
  <entry>
    <title>一些无聊的尝试</title>
    <link href="https://6-7.xyz/%F0%9F%99%83.html"/>
    <id>https://6-7.xyz/🙃.html</id>
    <published>2019-05-10T09:42:31.000Z</published>
    <updated>2019-05-14T10:10:21.969Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>先放几个自己成功安装的截图,教程后面慢慢写。<a id="more"></a></p><h1 id="VMware虚拟机安装windows-1"><a href="#VMware虚拟机安装windows-1" class="headerlink" title="VMware虚拟机安装windows 1"></a>VMware虚拟机安装windows 1</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/boring/win%201.png" ><h1 id="VMware虚拟机安装windows-3-1"><a href="#VMware虚拟机安装windows-3-1" class="headerlink" title="VMware虚拟机安装windows 3.1"></a>VMware虚拟机安装windows 3.1</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/boring/win%203.1.png"><h1 id="VMware虚拟机安装windows-3-2"><a href="#VMware虚拟机安装windows-3-2" class="headerlink" title="VMware虚拟机安装windows 3.2"></a>VMware虚拟机安装windows 3.2</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/boring/win%203.2.png"><h1 id="VMware虚拟机安装windows-95"><a href="#VMware虚拟机安装windows-95" class="headerlink" title="VMware虚拟机安装windows 95"></a>VMware虚拟机安装windows 95</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/boring/win%2095.png"><h1 id="VMware虚拟机安装windows-98"><a href="#VMware虚拟机安装windows-98" class="headerlink" title="VMware虚拟机安装windows 98"></a>VMware虚拟机安装windows 98</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/boring/win%2098.png"><h1 id="VMware虚拟机安装windows-me"><a href="#VMware虚拟机安装windows-me" class="headerlink" title="VMware虚拟机安装windows me"></a>VMware虚拟机安装windows me</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/boring/win%20me.png"><h1 id="VMware虚拟机安装windows-2000"><a href="#VMware虚拟机安装windows-2000" class="headerlink" title="VMware虚拟机安装windows 2000"></a>VMware虚拟机安装windows 2000</h1><img src="https://b-l.oss-cn-hongkong.aliyuncs.com/boring/win%202000.png">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;先放几个自己成功安装的截图,教程后面慢慢写。
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>动态路由实验RIP的配置</title>
    <link href="https://6-7.xyz/%E2%98%BA.html"/>
    <id>https://6-7.xyz/☺.html</id>
    <published>2019-05-08T08:17:27.000Z</published>
    <updated>2019-07-24T02:32:41.554Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>假设校园网通过一台三层交换机连到校园网出口路由器上，路由器再和校园外的另一台路由器连接。现要做适当配置，实现校园网内部主机与校园网外部主机之间的相互通信。为了简化网管的管理维护工作，学校决定采用RIPV2协议实现互通。</p></blockquote><a id="more"></a><h1 id="技术原理"><a href="#技术原理" class="headerlink" title="技术原理"></a><strong>技术原理</strong></h1><ol><li><strong>RIP(Routing Information Protocols,**</strong>路由信息协议)<strong>是应用较早、使用较普遍的IGP内部网管协议，使用于小型同类网络，是距离矢量协议；</strong></li><li>RIP<strong>协议跳数作为衡量路径开销的，</strong>RIP<strong>协议里规定最大跳数为15；</strong></li><li><strong>*RIP</strong>协议有两个版本：<strong>RIPv1</strong>和<strong>RIPv2</strong>，<strong>RIPv1</strong>属于有类路由协议，不支持<strong>VLSM</strong>，以广播形式进行路由信息的更新，更新周期为30秒；<strong>RIPv2</strong>属于无类路由协议，支持<strong>VLSM</strong>，以组播形式进行路由更细。</li></ol><h1 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a><strong>实验步骤</strong></h1><p> 建立建立packet tracer拓扑图</p><p>（1）在本实验中的三层交换机上划分VLAN10和VLAN20，其中VLAN10用于连接校园网主机，VLAN20用于连接R1。</p><p>（2）路由器之间通过V.35电缆通过串口连接，DCE端连接在R1上，配置其时钟频率64000。</p><p>（3）主机和交换机通过直连线，主机与路由器通过交叉线连接。</p><p>（4）在S3560上配置RIPV2路由协议。</p><p>（5）在路由器R1、R2上配置RIPV2路由协议。</p><p>（6）将PC1、PC2主机默认网关设置为与直连网路设备接口IP地址。</p><p>（7）验证PC1、PC2主机之间可以互相同信；</p><h1 id="实验设备"><a href="#实验设备" class="headerlink" title="实验设备"></a><strong>实验设备</strong></h1><p>PC 2台；Switch_3560 1台；Router-PT 2台；直连线；交叉线；DCE 串口线</p><p><img src="/img/route/tuopu.png" alt=""></p><p><code>PC1</code></p><p>​    IP:                192.168.1.2    </p><p>​    Submask:    255.255.255.0</p><p>​    Gateway:    192.168.1.1</p><p><code>PC2</code></p><p>​    IP:                192.168.2.2</p><p>​    Submask:    255.255.255.0</p><p>​    Gateway:    192.168.2.1</p><p>配置三层交换机<code>S3560</code></p><blockquote><p>Switch&gt;en<br>Switch#conf t<br>Switch(config)#vlan 10<br>Switch(config-vlan)#exit<br>Switch(config)#vlan 20<br>Switch(config-vlan)#exit<br>Switch(config)#int fa 0/1<br>Switch(config-if)#sw acc vlan 10<br>Switch(config-if)#exit<br>Switch(config)#int fa 0/2<br>Switch(config-if)#sw acc vlan 20<br>Switch(config-if)#exit<br>Switch(config)#int vlan 10</p><p>Switch(config-if)#ip add 192.168.1.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#int vlan 20</p><p>Switch(config-if)#ip add 192.168.3.1 255.255.255.0<br>Switch(config-if)#no shutdown<br>Switch(config-if)#exit<br>Switch(config)#ip routing<br>Switch(config)#router rip<br>Switch(config-router)#network 192.168.1.0<br>Switch(config-router)#network 192.168.3.0<br>Switch(config-router)#version 2</p></blockquote><p>配置路由器<code>R1</code></p><blockquote><p>Router&gt;en<br>Router#conf t<br>Router(config)#int fa 0/0<br>Router(config-if)#ip add 192.168.3.2 255.255.255.0<br>Router(config-if)#no shutdown</p><p>Router(config-if)#exit<br>Router(config)#int serial 2/0<br>Router(config-if)#ip add 192.168.4.1 255.255.255.0<br>Router(config-if)#no shutdown<br>Router(config-if)#clock rate 64000</p><p>Router(config)#router rip<br>Router(config-router)#network 192.168.3.0<br>Router(config-router)#network 192.168.4.0<br>Router(config-router)#version 2</p></blockquote><p>配置路由器<code>R2</code></p><blockquote><p>Router&gt;en<br>Router#conf t<br>Router(config)#int serial 2/0<br>Router(config-if)#ip add 192.168.4.2 255.255.255.0<br>Router(config-if)#no shutdown<br>Router(config-if)#exit<br>Router(config)#int fa 0/0<br>Router(config-if)#ip add 192.168.2.1 255.255.255.0<br>Router(config-if)#no shutdown</p><p>Router(config-if)#exit<br>Router(config)#router rip<br>Router(config-router)#network 192.168.2.0<br>Router(config-router)#network 192.168.4.0<br>Router(config-router)#version 2</p></blockquote><h1 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h1><p>验证之前先查看路由表是否正确,正确的如下所示。</p><p><img src="/img/route/s3560.png" alt=""></p><p><img src="/img/route/R0.png" alt=""></p><p><img src="/img/route/R1.png" alt=""></p><p><code>PC1</code>  ping  <code>PC2</code></p><p><img src="/img/route/%F0%9F%98%82.png" alt=""></p><p><strong><code>注意</code></strong>:开启动态路由应选择version2版本！</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;假设校园网通过一台三层交换机连到校园网出口路由器上，路由器再和校园外的另一台路由器连接。现要做适当配置，实现校园网内部主机与校园网外部主机之间的相互通信。为了简化网管的管理维护工作，学校决定采用RIPV2协议实现互通。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="数据通信" scheme="https://6-7.xyz/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/"/>
    
    
      <category term="路由" scheme="https://6-7.xyz/tags/%E8%B7%AF%E7%94%B1/"/>
    
      <category term="RIP" scheme="https://6-7.xyz/tags/RIP/"/>
    
  </entry>
  
</feed>
